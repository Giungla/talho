(()=>{let o=null,u="oculto",n="https://xef5-44zo-gegm.b2.xano.io",r=n+"/api:79PnTkh_",s="click",d="{count}",l=[`Temos apenas ${d} unidade disponível.`,`Temos apenas ${d} unidades disponíveis.`];var t={quantity:1,stockCount:0,product:o,selectedVariation:o};let c=location.pathname.split("/");function f(t,e){return{method:t,...e&&{credentials:"include"},headers:{Accept:"application/json","Content-Type":"application/json"}}}let p=new Proxy(t,{get(a,t){switch(t){case"variationsCount":return P(a.product?.variations??[]);case"hasPriceDifference":var{price:r,full_price:e}=p.prices;return r!==e;case"prices":{let{product:t,selectedVariation:e}=a;return t&&p.hasSelectedVariation?(r=t.variations.find(t=>t.id===e))?F(r.price,r.full_price):F():F()}case"BRLPrices":var{price:e,full_price:r}=p.prices;return F(q.format(e),q.format(r));case"computedFinalPrices":var{quantity:e,prices:r}=p,i=r.price*e,r=r.full_price*e;return{price:{price:i,full_price:r},currency:{price:q.format(i),full_price:q.format(r)}};case"hasSelectedVariation":return a.selectedVariation!==o;default:return Reflect.get(a,t)}},set(t,e,a){var r,i,n,t=Reflect.set(t,e,a);switch(e){case"quantity":V(O,String(a??1)),(r=p.product)&&p.hasSelectedVariation&&(r=t=>S("[data-wtf-price-value]",t),{BRLPrices:i,hasPriceDifference:n,computedFinalPrices:c}=p,V(r(v),i.price),V(r(h),i.full_price),V(r(z),c.currency.price),R(v,u,!n),R(h,u,!n));break;case"selectedVariation":(()=>{if(y&&I&&p.product){var{selectedVariation:e,product:a}=p,r=document.createDocumentFragment(),t=S("[data-wtf-weight-selector]"),i=p.variationsCount<2;if(i)return t?.remove();R(t,u,i);for(let t of a?.variations){var n=document.createElement("div"),c=e===t.id;j(n,"text-block"),R(n,"selecionado",c),V(n,b(t.label,/\./g,",")),c||T(n,s,()=>{var e;e=t.id,p.product?.variations.some(({id:t})=>t===e)&&(p.selectedVariation=e)}),r.appendChild(n)}y.replaceChildren(r)}})(),Reflect.set(p,"quantity",1);break;case"stockCount":i=p.stockCount,r=i<1,R(S("[data-wtf-shipping]"),u,r),R(S("[data-wtf-quantity-selector]"),u,r),R(g,u,r),R(E,u,0<i),(r=R(m,u,10<i||r))||(r=P(l)-1,V(S("div",m),b(l[C(0,r,i-1)],d,i.toString()))),H(0);break;case"product":var c=a;Reflect.set(p,"stockCount",c?.stock_quantity??0),Reflect.set(p,"selectedVariation",c?.variations[0].id??o)}return t}}),m=S("[data-wtf-error-message-sku-maximum]"),E=S("[data-wtf-error-message-invetory]"),A=S("[data-wtf-quantity-minus]"),B=S("[data-wtf-quantity-plus]"),O=S("[data-wtf-quantity-value]"),v=S("[data-wtf-price]"),h=S("[data-wtf-full-price]"),z=S("[data-wtf-total]"),y=S("[data-wtf-sku-list]"),I=S("[data-wtf-sku-item]"),e=S("[data-wtf-shipping-button]"),w=S("[data-wtf-shipping-form]"),a=S("[data-wtf-shipping-value]"),g=S("[data-wtf-comprar]"),k=S("[data-wtf-error-message-shipping]"),q=new Intl.NumberFormat("pt-BR",{currency:"BRL",style:"currency"});function b(t,e,a){return t.replace(e,a)}function _(t){return JSON.stringify(t)}function C(t,e,a){return Math.max(t,Math.min(e,a))}function P(t){return t.length}function S(t,e=document){return e?e.querySelector(t):o}function T(t,e,a,r){t&&t.addEventListener(e,a,r)}function V(t,e){t&&(t.textContent=e)}function j(t,...e){t&&t.classList.add(...e)}function L(t,...e){t&&t.classList.remove(...e)}function R(t,e,a){return!!t&&t.classList.toggle(e,a)}function x(t){return{message:t,succeeded:!1}}function D(t){return{data:t,succeeded:!0}}function F(t=0,e=0){return{price:t,full_price:e}}function H(t){t+=p.quantity,t=C(1,Math.min(p.stockCount,10),t);t!==p.quantity&&(p.quantity=t)}async function N(t){t.preventDefault();var{quantity:t,product:e,selectedVariation:a}=p;if(a&&e&&0!==p.stockCount){t=await(async t=>{var e="Falha ao adicionar o produto";try{var a=await fetch(r+"/cart/handle",{...f("POST",!0),body:_({item:t,operation:"add"})});return a.ok?D(await a.json()):x((await a.json())?.message??e)}catch(t){return x("[CATCH] "+e)}})({quantity:t,sku_id:a,reference_id:e.slug});if(!t.succeeded)return alert("A adição falhou");p.quantity=1,j(S("#carrinho-flutuante"),"carrinhoflutuante--visible"),localStorage.setItem("talho_cart_items",_(t.data))}}function M(t){return t.replace(/^(\d{0,5})(\d{0,3})/,(t,e,a)=>{var r,i=[];for(r of[e,a])r&&i.push(r);return i.join("-")})}function i(){var t=S("form",w);if(t){var e,a,i;for(e of["name","method","data-name","aria-label","data-wf-page-id","data-wf-element-id","data-turnstile-sitekey"])a=t,i=e,a&&a.removeAttribute(i);L(w,"w-form"),t.parentElement.innerHTML=t.outerHTML;let r=S("#shipping-cep-form");r&&(T(r,"input",t=>{t.stopPropagation();var e=t.target,a=e.value.replace(/\D+/g,"");"cep"===e.name&&e.value!==M(a)&&t.isTrusted&&(e.value=M(a),e.dispatchEvent(new Event("input")))}),T(r,"submit",async t=>{t.preventDefault();var e,a=await(async t=>{var e="Houve uma falha ao gerar a cotação";try{var a=await fetch(n+"/api:i6etHc7G/site/product-delivery",{...f("POST",!0),body:_(t)});return a.ok?D(await a.json()):x((await a.json())?.message??e)}catch(t){return x(e)}})({cep:r.cep.value,reference_id:c[P(c)-1]});if(R(k,u,a.succeeded),a.succeeded)switch(a.data.type){case"quotation":return $(a.data.data);case"locationlist":return e=a.data.data,void console.log(e.length," localizações recebidas")}else V(S("div",k),a.message)}))}}function $(t){j(e,u),j(w,u),L(a,u);t=Math.max(t.total/100-(t.has_subsidy?t.subsidy_value:0),0);V(S("[data-wtf-quotation-price]",a),0===t?"Frete grátis":q.format(t)),T(S("[data-wtf-quotation-reload]",a),"click",t=>{L(w,u),j(a,u)},{once:!0})}(async t=>{var e="Houve uma falha ao capturar o produto";try{var a=await fetch(r+"/product/single-product-page",{...f("POST",!0),body:_({quantity:1,reference_id:t})});return a.ok?D(await a.json()):x((await a.json())?.message??e)}catch(t){return x(e)}})(c[P(c)-1]).then(t=>{t.succeeded&&(p.product=t.data.product,t.data.delivery!==o)&&(i(),$(t.data.delivery))}).then(()=>{T(B,s,()=>H(1)),T(A,s,()=>H(-1)),T(g,s,N),T(e,s,t=>{t.preventDefault(),j(e,u),L(w,u),i()},{once:!0})})})();