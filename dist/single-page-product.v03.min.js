(()=>{let o=null,u="oculto",r="https://xef5-44zo-gegm.b2.xano.io/api:79PnTkh_",s="click",d="{count}",l=[`Temos apenas ${d} unidade disponível.`,`Temos apenas ${d} unidades disponíveis.`];var t={quantity:1,stockCount:0,product:o,selectedVariation:o};let p=new Proxy(t,{get(a,t){switch(t){case"variationsCount":return _(a.product?.variations??[]);case"hasPriceDifference":var{price:r,full_price:e}=p.prices;return r!==e;case"prices":{let{product:t,selectedVariation:e}=a;return t&&p.hasSelectedVariation?(r=t.variations.find(t=>t.id===e))?x(r.price,r.full_price):x():x()}case"BRLPrices":var{price:e,full_price:r}=p.prices;return x(n.format(e),n.format(r));case"computedFinalPrices":var{quantity:e,prices:r}=p,i=r.price*e,r=r.full_price*e;return{price:{price:i,full_price:r},currency:{price:n.format(i),full_price:n.format(r)}};case"hasSelectedVariation":return a.selectedVariation!==o;default:return Reflect.get(a,t)}},set(t,e,a){var r,i,n,t=Reflect.set(t,e,a);switch(e){case"quantity":P(h,String(a??1)),(r=p.product)&&p.hasSelectedVariation&&(r=t=>V("[data-wtf-price-value]",t),{BRLPrices:i,hasPriceDifference:n,computedFinalPrices:c}=p,P(r(v),i.price),P(r(y),i.full_price),P(r(w),c.currency.price),R(v,u,!n),R(y,u,!n));break;case"selectedVariation":(()=>{if(g&&k&&p.product){var{selectedVariation:e,product:a}=p,r=document.createDocumentFragment(),t=V("[data-wtf-weight-selector]"),i=p.variationsCount<2;if(i)return t?.remove();R(t,u,i);for(let t of a?.variations){var n=document.createElement("div"),c=e===t.id;S(n,"text-block"),R(n,"selecionado",c),P(n,q(t.label,/\./g,",")),c||b(n,s,()=>{var e;e=t.id,p.product?.variations.some(({id:t})=>t===e)&&(p.selectedVariation=e)}),r.appendChild(n)}g.replaceChildren(r)}})(),Reflect.set(p,"quantity",1);break;case"stockCount":i=p.stockCount,R(m,u,0<i),(r=R(f,u,10<i||i<1))||(r=_(l)-1,P(V("div",f),q(l[C(0,r,i-1)],d,i.toString()))),L(0);break;case"product":var c=a;Reflect.set(p,"stockCount",c?.stock_quantity??0),Reflect.set(p,"selectedVariation",c?.variations[0].id??o)}return t}}),f=V("[data-wtf-error-message-sku-maximum]"),m=V("[data-wtf-error-message-invetory]"),e=V("[data-wtf-quantity-minus]"),a=V("[data-wtf-quantity-plus]"),h=V("[data-wtf-quantity-value]"),v=V("[data-wtf-price]"),y=V("[data-wtf-full-price]"),w=V("[data-wtf-total]"),g=V("[data-wtf-sku-list]"),k=V("[data-wtf-sku-item]"),i=V("[data-wtf-comprar]"),n=new Intl.NumberFormat("pt-BR",{currency:"BRL",style:"currency"});function q(t,e,a){return t.replace(e,a)}function c(t){return JSON.stringify(t)}function C(t,e,a){return Math.max(t,Math.min(e,a))}function _(t){return t.length}function V(t,e=document){return e?e.querySelector(t):o}function b(t,e,a,r){t&&t.addEventListener(e,a,r)}function P(t,e){t&&(t.textContent=e)}function S(t,...e){t&&t.classList.add(...e)}function R(t,e,a){return!!t&&t.classList.toggle(e,a)}function j(t){return{message:t,succeeded:!1}}function T(t){return{data:t,succeeded:!0}}function x(t=0,e=0){return{price:t,full_price:e}}function L(t){t+=p.quantity,t=C(1,Math.min(p.stockCount,10),t);t!==p.quantity&&(p.quantity=t)}async function F(t){t.preventDefault();var{quantity:t,product:e,selectedVariation:a}=p;if(a&&e&&0!==p.stockCount){t=await(async t=>{var e="Falha ao adicionar o produto";try{var a=await fetch(r+"/cart/handle",{method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},body:c({item:t,operation:"add"})});return a.ok?T(await a.json()):j((await a.json())?.message??e)}catch(t){return j("[CATCH] "+e)}})({quantity:t,sku_id:a,reference_id:e.slug});if(!t.succeeded)return alert("A adição falhou");p.quantity=1,S(V("#carrinho-flutuante"),"carrinhoflutuante--visible"),localStorage.setItem("talho_cart_items",c(t.data))}}(async t=>{var e="Houve uma falha ao capturar o produto";try{var a=await fetch(r+"/product/single-product-page",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:c({quantity:1,reference_id:t})});return a.ok?T(await a.json()):j((await a.json())?.message??e)}catch(t){return j(e)}})((t=location.pathname.split("/"))[_(t)-1]).then(t=>{t.succeeded&&(p.product=t.data)}).then(()=>{b(a,s,()=>L(1)),b(e,s,()=>L(-1)),b(i,s,F)})})();