(()=>{let u="oculto",H="mensagemdeerro",o="https://xef5-44zo-gegm.b2.xano.io";function s(e,a=document){return a.querySelector(e)}function n(e,a,t,n){e.addEventListener(a,t,n)}function i(e,a,t){return e.split(a,t)}function a(e){var[e,a]=i(e,"=");return{name:e,value:a}}function e(e,a){e&&e.removeAttribute(a)}function c(e,...a){e&&e.classList.add(...a)}function r(e,...a){e&&e.classList.remove(...a)}function l(e,a,t){e&&e.classList.toggle(a,t)}function f(e){return{data:e,succeeded:!0}}function p(e){return{message:e,succeeded:!1}}function v(){window.location.href="/acessos/entrar?redirect_to="+encodeURIComponent(location.pathname)}function d(e,a){e&&(l(e,u,!a),e.textContent=a??"")}function m(e){if(Object.assign(w,e),z){var a,t;n(z,"click",()=>{r(L,u),c(z,u)},{once:!0});for([a,t]of[[j,w.cpf],[y,w.name],[N,w.birthday],[k,w.telephone],[T,w.last_name]])((e,a)=>{e&&"INPUT"===e.tagName&&(e.value=a??"")})(a,t);r(z,u),c(L,u)}}let w=new Proxy({cpf:"",name:"",email:"",birthday:"",telephone:"",isFormVisible:!1},{get(e,a){var t=Reflect.get(e,a);return"fullName"!==a?t:e?.name+" "+e?.last_name},set(e,a,t,n){e=Reflect.set(e,a,t);switch(a){case"name":case"last_name":d(M,n?.fullName??"");break;case"birthday":d(Z,t);break;case"telephone":d(R,t);break;case"cpf":d(S,t);break;case"email":d(J,t);break;case"points":d(I,t)}return e}});t="__Host-Talho-AuthToken";var t,h=!!(h=i(document.cookie,"; ").find(e=>{e=a(e).name;return e===t}))&&a(h).value;let $={Accept:"application/json","Content-Type":"application/json",...h&&{Authorization:h}};var g=s("#wf-form-update-user-data");if(g){for(var O of["name","method","data-name","aria-label","data-wf-page-id","data-wf-element-id","data-turnstile-sitekey"])e(g,O);h=g.parentElement;e(s('[type="submit"]',g),"disabled"),r(h,"w-form"),g.remove(),h.insertAdjacentHTML("beforeend",g.outerHTML)}let b=s("#wf-form-update-user-data"),I=(n(b,"submit",async a=>{a.preventDefault(),a.stopPropagation();a=b,t="cpf";var a=a.hasOwnProperty(t),t=[F,q,V,G],t=(a&&t.splice(2,0,B),t.find(e=>!1===e().at(1)));if(t)s(`[data-${t().at(0).replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}]`,b)?.focus({preventScroll:!1});else{t={birthday:i(N?.value??"","/").reverse().join("-"),cpf:j?.value,name:y?.value,telephone:k?.value,last_name:T?.value},a=(a&&Object.assign(t,{cpf:j?.value}),await(async e=>{var a="Houve uma falha ao salvar seus dados. Tente novamente mais tarde.";try{var t,n=await fetch(o+"/api:TJEuMepe/user/edit",{method:"PUT",headers:$,body:JSON.stringify(e)});return n.ok?f(await n.json()):(t=await n.json(),401===n.status&&v(),p(t?.message??a))}catch(e){return p(a)}})(t));{t=b;var n=a;var r=!n.succeeded,d=s("[data-wtf-user-update-error-message]",t);let e=s("[data-wtf-user-update-success-message]",t);l(d,u,!r),l(e,u,r),r?(t=d&&s("div",d))&&(t.textContent=n.message):setTimeout(()=>c(e,u),8e3)}a.succeeded&&(window?.refreshOrders?.(),m(a.data))}}),s("[data-wtf-score]")),M=s("[data-wtf-name]"),J=s("[data-wtf-email]"),R=s("[data-wtf-phone]"),S=s("[data-wtf-cpf]"),Z=s("[data-wtf-birthday]"),y=s("[data-wtf-name-update]"),T=s("[data-wtf-last-name-update]"),k=s("[data-wtf-phone-update]"),j=s("[data-wtf-cpf-update]"),N=s("[data-wtf-birthday-update]"),z=s("[data-wtf-edit-account-data]"),L=s("[data-wtf-update-account-data]");for(let{field:e,validator:a}of[{field:y,validator:F},{field:T,validator:q},{field:j,validator:B},{field:k,validator:V},{field:N,validator:G}])e&&(n(e,"blur",a),n(e,"input",()=>x(e,!0)));function U(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function A(e){e=E(e);return{cleaned:e,size:C(e)}}function _(e){return e.trim().replace(/\s+/g," ")}function C(e){return e.length}function E(e){return e.replace(/\D/g,"")}function P(a){return function(e){return[a,e]}}function x(e,a){l(e.closest("[data-wtf-wrapper]"),H,!a)}function D(e){return/^[a-zA-Z\s]+$/.test(e)}function F(){var e,a=P("wtfNameUpdate");return y?(e=1<C(e=_(U(y.value)))&&D(e),x(y,e),a(e)):a(!1)}function q(){var e,a=P("wtfLastNameUpdate");return T?(e=0<C(e=_(U(T.value)))&&D(e),x(T,e),a(e)):a(!1)}function B(){var e,a=P("wtfCpfUpdate");return j?(e=/^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(j.value)&&(a=>{if(11!==C(a=E(a))||/^(\d)\1{10}$/.test(a))return!1;let r=!0;return[9,10].forEach(function(t){let n=0,e;i(a,"").splice(0,t).forEach(function(e,a){n+=parseInt(e)*(t+2-(a+1))}),((e=n%11)<2?0:11-e)!==parseInt(a.substring(t,t+1))&&(r=!1)}),r})(j.value),x(j,e),a(e)):a(!1)}function V(){var e,a=P("wtfPhoneUpdate");return k?(e=/^\(\d{2}\)\s\d{4,5}-\d{4}$/.test(k.value),x(k,e),a(e)):a(!1)}function G(){var e,a,t,n,r=P("wtfBirthdayUpdate");return N?(a=N.value,e=/^(\d{2})\/(\d{2})\/(19|20)(\d{2})$/g.test(a),[a,n,t]=i(a,"/"),t=new Date(t+`-${n}-${a}T00:00:00.000Z`).getTime(),n=e&&!isNaN(t)&&Date.now()>t,x(N,n),r(n)):r(!1)}k&&n(k,"input",()=>{k.value=(e=>{var{cleaned:e,size:a}=A(e);return 0===a?e:0<a&&a<3?e.replace(/(\d{0,2})/,"($1"):a<7?e.replace(/(\d{2})(\d{0,4})/,"($1) $2"):a<=10?e.replace(/(\d{2})(\d{4})(\d{1,4})/,"($1) $2-$3"):e.replace(/(\d{2})(\d{5})(\d{4})/,"($1) $2-$3")})(k.value)}),j&&n(j,"input",()=>{j.value=(e=>{var{cleaned:e,size:a}=A(e);return a<4?e:a<7?e.replace(/(\d{3})(\d{1,3})/,"$1.$2"):a<=9?e.replace(/(\d{3})(\d{3})(\d{1,3})/,"$1.$2.$3"):e.replace(/(\d{3})(\d{3})(\d{3})(\d{1,2})/,"$1.$2.$3-$4")})(j.value)}),N&&n(N,"input",()=>{N.value=(e=>{var{cleaned:e,size:a}=A(e);return a<3?e:a<5?e.replace(/(\d{2})(\d{1,2})/,"$1/$2"):e.replace(/(\d{2})(\d{2})(\d{1,4})/,"$1/$2/$3")})(N.value)}),(async()=>{var a="Houve uma falha ao carregar seus dados. Tente novamente mais tarde.";try{var e,t=await fetch(o+"/api:TJEuMepe/user/get",{headers:$});return t.ok?f(await t.json()):(e=await t.json(),401===t.status&&v(),p(e?.message??a))}catch(e){return p(a)}})().then(e=>{e.succeeded&&m(e.data)})})();