"use strict";(()=>{var M="; ";function O(e){let n=document.cookie.split(M).find(t=>{let{name:r}=x(t);return r===e});return n?x(n).value:!1}function x(e){let[n,t]=e.split("=");return{name:n,value:t}}function T(e,n,t={}){if(e.length===0)throw new Error("'setCookie' should receive a valid cookie name");if(!["string","number","boolean"].includes(typeof n)||n.toString().length===0)throw new Error("'setCookie' should receive a valid cookie value");let r=[`${e}=${n}`];t?.expires&&t?.expires instanceof Date&&r.push("expires="+t.expires.toUTCString()),t.maxAge&&r.push(`maxAge=${t.maxAge}`),t?.sameSite&&typeof t?.sameSite=="string"&&r.push(`SameSite=${t?.sameSite}`),t?.path&&r.push(`path=${t?.path}`),t?.domain&&r.push(`domain=${t?.path}`),t?.httpOnly&&r.push("HttpOnly"),t?.secure&&r.push("Secure");let o=r.join(M);return document.cookie=o,o}var v="__Host-Talho-Session-Cookie",C="X-Talho-Session";function l(e){let n=this?.get(C);return n&&T(v,n,{path:"/",secure:!0,sameSite:"Strict",maxAge:_(90)}),{message:e,succeeded:!1}}function S(e){let n=this?.get(C);return n&&T(v,n,{path:"/",secure:!0,sameSite:"Strict",maxAge:_(90)}),{data:e,succeeded:!0}}function P(e,n="GET"){let t=new Headers({Accept:"application/json","Content-Type":"application/json"});for(let[o,s]of e)t.set(o,s);let r=O(v);return r&&t.set(C,r),{method:n,headers:t}}function _(e){return 86400*1e3*e}var Z=new Intl.NumberFormat("pt-BR",{currency:"BRL",style:"currency"});var g=null,c="oculto",ee="selecionado",te="talho_cart_items",ne="carrinhoflutuante--visible",G="https://xef5-44zo-gegm.b2.xano.io",Y=`${G}/api:79PnTkh_`,y="click",re=1,oe=10,D="POST",H="{count}",F=[`Temos apenas ${H} unidade dispon\xEDvel.`,`Temos apenas ${H} unidades dispon\xEDveis.`],ae={quantity:1,stockCount:0,product:g,selectedVariation:g},k=location.pathname.split("/"),i=new Proxy(ae,{get(e,n){switch(n){case"variationsCount":return L(e.product?.variations??[]);case"hasPriceDifference":{let{price:t,full_price:r}=i.prices;return t!==r}case"prices":{let{product:t,selectedVariation:r}=e;if(!t||!i.hasSelectedVariation)return b();let o=t.variations.find(s=>s.id===r);return o?b(o.price,o.full_price):b()}case"BRLPrices":{let{price:t,full_price:r}=i.prices;return b(h.format(t),h.format(r))}case"computedFinalPrices":{let{quantity:t,prices:r}=i,o=r.price*t,s=r.full_price*t;return{price:{price:o,full_price:s},currency:{price:h.format(o),full_price:h.format(s)}}}case"hasSelectedVariation":return e.selectedVariation!==g;default:return Reflect.get(e,n)}},set(e,n,t){let r=Reflect.set(e,n,t);switch(n){case"quantity":f(ue,String(t??1)),ye();break;case"selectedVariation":Pe(),Reflect.set(i,"quantity",1);break;case"stockCount":he(),I(0);break;case"product":{let o=t;Reflect.set(i,"stockCount",o?.stock_quantity??0),Reflect.set(i,"selectedVariation",o?.variations[0].id??g)}}return r}}),K=a("[data-wtf-error-message-sku-maximum]"),ie=a("[data-wtf-error-message-invetory]"),se=a("[data-wtf-quantity-minus]"),ce=a("[data-wtf-quantity-plus]"),ue=a("[data-wtf-quantity-value]"),V=a("[data-wtf-price]"),Q=a("[data-wtf-full-price]"),de=a("[data-wtf-total]"),B=a("[data-wtf-sku-list]"),le=a("[data-wtf-sku-item]"),N=a("[data-wtf-shipping-button]"),E=a("[data-wtf-shipping-form]"),R=a("[data-wtf-shipping-value]"),z=a("[data-wtf-comprar]"),j=a("[data-wtf-error-message-shipping]"),h=new Intl.NumberFormat("pt-BR",{currency:"BRL",style:"currency"});function X(e,n,t){return e.replace(n,t)}function w(e){return JSON.stringify(e)}function J(e,n,t){return Math.max(e,Math.min(n,t))}function L(e){return e.length}function a(e,n=document){return n?n.querySelector(e):g}function p(e,n,t,r){if(e)return e.addEventListener(n,t,r),()=>e.removeEventListener(n,t,r)}function f(e,n){e&&(e.textContent=n)}function pe(e,n){e&&e.removeAttribute(n)}function m(e,...n){e&&e.classList.add(...n)}function A(e,...n){e&&e.classList.remove(...n)}function d(e,n,t){return e?e.classList.toggle(n,t):!1}function b(e=0,n=0){return{price:e,full_price:n}}async function fe(e){let n="Houve uma falha ao capturar o produto";try{let t=await fetch(`${Y}/product/single-product-page`,{...P([],D),body:w({quantity:1,reference_id:e})});if(!t.ok){let o=await t.json();return l.call(t.headers,o?.message??n)}let r=await t.json();return S.call(t.headers,r)}catch{return l(n)}}function I(e){let n=e+i.quantity,t=Math.min(i.stockCount,oe),r=J(re,t,n);r!==i.quantity&&(i.quantity=r)}function me(e){i.product?.variations.some(({id:t})=>t===e)&&(i.selectedVariation=e)}async function ge(e){e.preventDefault();let{quantity:n,product:t,selectedVariation:r}=i;if(!r||!t||i.stockCount===0)return;let o=await Se({quantity:n,sku_id:r,reference_id:t.slug});if(!o.succeeded)return alert("A adi\xE7\xE3o falhou");i.quantity=1,m(a("#carrinho-flutuante"),ne),localStorage.setItem(te,w(o.data))}async function Se(e){let n="Falha ao adicionar o produto";try{let t=await fetch(`${Y}/cart/handle`,{...P([],D),body:w({item:e,operation:"add"})});if(!t.ok){let o=await t.json();return l.call(t.headers,o?.message??n)}let r=await t.json();return S.call(t.headers,r)}catch{return l(`[CATCH] ${n}`)}}function Pe(){if(!B||!le||!i.product)return;let{selectedVariation:e,product:n}=i,t=document.createDocumentFragment(),r=a("[data-wtf-weight-selector]"),o=i.variationsCount<2;if(o)return r?.remove();d(r,c,o);for(let s of n?.variations){let u=document.createElement("div"),q=e===s.id;m(u,"text-block"),d(u,ee,q),f(u,X(s.label,/\./g,",")),q||p(u,y,()=>me(s.id)),t.appendChild(u)}B.replaceChildren(t)}function ye(){if(!i.product||!i.hasSelectedVariation)return;let n=s=>a("[data-wtf-price-value]",s),{BRLPrices:t,hasPriceDifference:r,computedFinalPrices:o}=i;f(n(V),t.price),f(n(Q),t.full_price),f(n(de),o.currency.price),d(V,c,!r),d(Q,c,!r)}function he(){let{stockCount:e}=i,n=e<1;if(d(a("[data-wtf-shipping]"),c,n),d(a("[data-wtf-quantity-selector]"),c,n),d(z,c,n),d(ie,c,e>0),d(K,c,e>10||n))return;let r=L(F)-1;f(a("div",K),X(F[J(0,r,e-1)],H,e.toString()))}function U(e){return e.replace(/^(\d{0,5})(\d{0,3})/,(n,t,r)=>{let o=[];for(let s of[t,r])s&&o.push(s);return o.join("-")})}function $(){let e=a("form",E);if(!e)return;let n=["name","method","data-name","aria-label","data-wf-page-id","data-wf-element-id","data-turnstile-sitekey"];for(let o of n)pe(e,o);A(E,"w-form");let t=e.parentElement;t.innerHTML=e.outerHTML;let r=a("#shipping-cep-form");r&&(p(r,"input",o=>{o.stopPropagation();let s=o.target,u=s.value.replace(/\D+/g,"");s.name!=="cep"||s.value===U(u)||!o.isTrusted||(s.value=U(u),s.dispatchEvent(new Event("input")))}),p(r,"submit",async o=>{o.preventDefault();let s=r.cep.value,u=await Te({cep:s,reference_id:k[L(k)-1]});if(d(j,c,u.succeeded),!u.succeeded){f(a("div",j),u.message);return}switch(u.data.type){case"quotation":return W(u.data.data);case"locationlist":return Ee(u.data.data)}}))}function W(e){m(N,c),m(E,c),A(R,c);let n=Math.max(e.total/100-(e.has_subsidy?e.subsidy_value:0),0);f(a("[data-wtf-quotation-price]",R),n===0?"Frete gr\xE1tis":h.format(n)),p(a("[data-wtf-quotation-reload]",R),"click",t=>{A(E,c),m(R,c)},{once:!0})}function Ee(e){console.log(e.length," localiza\xE7\xF5es recebidas")}async function Te(e){let n="Houve uma falha ao gerar a cota\xE7\xE3o";try{let t=await fetch(`${G}/api:i6etHc7G/site/product-delivery`,{...P([],D),body:w(e)});if(!t.ok){let o=await t.json();return l.call(t.headers,o?.message??n)}let r=await t.json();return S.call(t.headers,r)}catch{return l(n)}}fe(k[L(k)-1]).then(e=>{e.succeeded&&(i.product=e.data.product,e.data.delivery!==g&&($(),W(e.data.delivery)))}).then(()=>{p(ce,y,()=>I(1)),p(se,y,()=>I(-1)),p(z,y,ge),p(N,y,e=>{e.preventDefault(),m(N,c),A(E,c),$()},{once:!0})});})();
