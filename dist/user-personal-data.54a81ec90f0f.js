"use strict";(()=>{var K="; ";function N(n){let o=document.cookie.split(K).find(a=>{let{name:i}=G(a);return i===n});return o?G(o).value:!1}function G(n){let[o,a]=n.split("=");return{name:o,value:a}}function q(n,o,a={}){if(n.length===0)throw new Error("'setCookie' should receive a valid cookie name");if(!["string","number","boolean"].includes(typeof o)||o.toString().length===0)throw new Error("'setCookie' should receive a valid cookie value");let i=[`${n}=${o}`];a?.expires&&a?.expires instanceof Date&&i.push("expires="+a.expires.toUTCString()),a.maxAge&&i.push(`maxAge=${a.maxAge}`),a?.sameSite&&typeof a?.sameSite=="string"&&i.push(`SameSite=${a?.sameSite}`),a?.path&&i.push(`path=${a?.path}`),a?.domain&&i.push(`domain=${a?.path}`),a?.httpOnly&&i.push("HttpOnly"),a?.secure&&i.push("Secure");let c=i.join(K);return document.cookie=c,c}var _e=401,z="__Host-Talho-AuthToken",j="__Host-Talho-Session-Cookie",V="X-Talho-Session";function Re(n){!n||n.status!==_e||(location.href=J("/acessos/entrar",{redirect_to:encodeURIComponent(location.pathname)}))}function ie(n){let o=n?.headers.get(V);o&&q(j,o,{path:"/",secure:!0,sameSite:"Strict",expires:new Date(Date.now()+B(90))})}function _(n){return ie(this),Re(this),{message:n,succeeded:!1}}function D(n){return ie(this),{data:n,succeeded:!0}}function k(n=[],o="GET"){let a=new Headers({Accept:"application/json","Content-Type":"application/json"});for(let[A,y]of n)a.set(A,y);let i=N(j);i&&a.set(V,i);let c=N(z);return c&&a.set("Authorization",c),{method:o,headers:a}}function B(n){return 86400*1e3*n}var Ce=new Intl.NumberFormat("pt-BR",{currency:"BRL",style:"currency"});var ue=null,g="oculto";function s(n,o=document){return o?o.querySelector(n):ue}function E(n,o,a,i){if(n)return n.addEventListener(o,a,i),()=>n.removeEventListener(o,a,i)}function $(n,o){n&&n.removeAttribute(o)}function I(n,...o){n&&n.classList.add(...o)}function L(n,...o){n&&n.classList.remove(...o)}function R(n,o,a){return n?n.classList.toggle(o,a):!1}function F(n,o){n&&(n.textContent=typeof o=="string"?o:o.toString())}function J(n,o={}){let a=new URL(`${location.protocol}//${location.hostname}`),i=new URL(n,a);for(let[c,A]of Object.entries(o))i.searchParams.set(c,A);return i.toString()}function Y(n){return JSON.stringify(n)}function U(n){return n.replace(/\D+/g,"")}function C(n){return n.length}function P(n,o,a){return n.split(o,a)}var Z={AC:"Acre",AL:"Alagoas",AP:"Amap\xE1",AM:"Amazonas",BA:"Bahia",CE:"Cear\xE1",DF:"Distrito Federal",ES:"Esp\xEDrito Santo",GO:"Goi\xE1s",MA:"Maranh\xE3o",MT:"Mato Grosso",MS:"Mato Grosso do Sul",MG:"Minas Gerais",PA:"Par\xE1",PB:"Para\xEDba",PR:"Paran\xE1",PE:"Pernambuco",PI:"Piau\xED",RJ:"Rio de Janeiro",RN:"Rio Grande do Norte",RS:"Rio Grande do Sul",RO:"Rond\xF4nia",RR:"Roraima",SC:"Santa Catarina",SP:"S\xE3o Paulo",SE:"Sergipe",TO:"Tocantins"},Oe=Object.keys(Z),Ne=Object.values(Z);var X="https://xef5-44zo-gegm.b2.xano.io";(function(){let n="mensagemdeerro";function o(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function a(e,t){return e.hasOwnProperty(t)}function i(e,t){let r=!t.succeeded,u=s("[data-wtf-user-update-error-message]",e),d=s("[data-wtf-user-update-success-message]",e);if(R(u,g,!r),R(d,g,r),!r){setTimeout(()=>I(d,g),8e3);return}let p=u&&s("div",u);F(p,t.message)}function c(e,t){R(e,g,!t),F(e,t??"")}function A(e){Object.assign(y,e),ye()}let y=new Proxy({cpf:"",name:"",email:"",birthday:"",telephone:"",isFormVisible:!1},{get(e,t){let r=Reflect.get(e,t);switch(t){case"fullName":return`${e?.name} ${e?.last_name}`;default:return r}},set(e,t,r,u){let d=Reflect.set(e,t,r);switch(t){case"name":case"last_name":c(de,u?.fullName??"");break;case"birthday":c(ge,r);break;case"telephone":c(fe,r);break;case"cpf":c(me,r);break;case"email":c(pe,r);break;case"points":c(le,r);break}return d}}),ce=["name","method","data-name","aria-label","data-wf-page-id","data-wf-element-id","data-turnstile-sitekey"],h=s("#wf-form-update-user-data");if(h){for(let r of ce)$(h,r);let e=h.parentElement,t=s('[type="submit"]',h);$(t,"disabled"),L(e,"w-form"),h.remove(),e.insertAdjacentHTML("beforeend",h.outerHTML)}let M=s("#wf-form-update-user-data");E(M,"submit",async e=>{e.preventDefault(),e.stopPropagation();let t=a(M,"cpf"),r=[ne,re,ae,se];t&&r.splice(2,0,oe);let u=r.find(T=>T().at(1)===!1);if(u){let T=o(u().at(0));s(`[data-${T}]`,M)?.focus({preventScroll:!1});return}let p={birthday:P(m?.value??"","/").reverse().join("-"),cpf:l?.value,name:x?.value,telephone:f?.value,last_name:b?.value};t&&Object.assign(p,{cpf:l?.value});let S=await be(p);i(M,S),S.succeeded&&(window?.refreshOrders?.(),A(S.data))});let le=s("[data-wtf-score]"),de=s("[data-wtf-name]"),pe=s("[data-wtf-email]"),fe=s("[data-wtf-phone]"),me=s("[data-wtf-cpf]"),ge=s("[data-wtf-birthday]"),x=s("[data-wtf-name-update]"),b=s("[data-wtf-last-name-update]"),f=s("[data-wtf-phone-update]"),l=s("[data-wtf-cpf-update]"),m=s("[data-wtf-birthday-update]"),w=s("[data-wtf-edit-account-data]"),W=s("[data-wtf-update-account-data]"),Ee=[{field:x,validator:ne},{field:b,validator:re},{field:l,validator:oe},{field:f,validator:ae},{field:m,validator:se}];for(let{field:e,validator:t}of Ee)e&&(E(e,"blur",t),E(e,"input",()=>v(e,!0)));f&&E(f,"input",()=>{f.value=Te(f.value)}),l&&E(l,"input",()=>{l.value=Ae(l.value)}),m&&E(m,"input",()=>{m.value=he(m.value)});function ye(){if(!w)return;E(w,"click",()=>{L(W,g),I(w,g)},{once:!0});let e=[[l,y.cpf],[x,y.name],[m,y.birthday],[f,y.telephone],[b,y.last_name]];for(let[t,r]of e)Se(t,r);L(w,g),I(W,g)}function Se(e,t){!e||e.tagName!=="INPUT"||(e.value=t??"")}function Q(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function Te(e){let{cleaned:t,size:r}=H(e);return r===0?t:r>0&&r<3?t.replace(/(\d{0,2})/,"($1"):r<7?t.replace(/(\d{2})(\d{0,4})/,"($1) $2"):r<=10?t.replace(/(\d{2})(\d{4})(\d{1,4})/,"($1) $2-$3"):t.replace(/(\d{2})(\d{5})(\d{4})/,"($1) $2-$3")}function Ae(e){let{cleaned:t,size:r}=H(e);return r<4?t:r<7?t.replace(/(\d{3})(\d{1,3})/,"$1.$2"):r<=9?t.replace(/(\d{3})(\d{3})(\d{1,3})/,"$1.$2.$3"):t.replace(/(\d{3})(\d{3})(\d{3})(\d{1,2})/,"$1.$2.$3-$4")}function he(e){let{cleaned:t,size:r}=H(e);return r<3?t:r<5?t.replace(/(\d{2})(\d{1,2})/,"$1/$2"):t.replace(/(\d{2})(\d{2})(\d{1,4})/,"$1/$2/$3")}function H(e){let t=U(e);return{cleaned:t,size:C(t)}}function ee(e){return e.trim().replace(/\s+/g," ")}function O(e){return function(t){return[e,t]}}function v(e,t){let r=e.closest("[data-wtf-wrapper]");R(r,n,!t)}function te(e){return/^[a-zA-Z\s]+$/.test(e)}function ne(){let e=O("wtfNameUpdate");if(!x)return e(!1);let t=ee(Q(x.value)),r=C(t)>1&&te(t);return v(x,r),e(r)}function re(){let e=O("wtfLastNameUpdate");if(!b)return e(!1);let t=ee(Q(b.value)),r=C(t)>0&&te(t);return v(b,r),e(r)}function oe(){let e=O("wtfCpfUpdate");if(!l)return e(!1);let t=/^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(l.value)&&xe(l.value);return v(l,t),e(t)}function ae(){let e=O("wtfPhoneUpdate");if(!f)return e(!1);let t=/^\(\d{2}\)\s\d{4,5}-\d{4}$/.test(f.value);return v(f,t),e(t)}function se(){let e=O("wtfBirthdayUpdate");if(!m)return e(!1);let t=m.value,r=/^(\d{2})\/(\d{2})\/(19|20)(\d{2})$/g.test(t),[u,d,p]=P(t,"/"),S=new Date(`${p}-${d}-${u}T00:00:00.000Z`).getTime(),T=r&&!isNaN(S)&&Date.now()>S;return v(m,T),e(T)}function xe(e){if(e=U(e),C(e)!==11||/^(\d)\1{10}$/.test(e))return!1;let t=!0;return[9,10].forEach(function(u){let d=0,p;P(e,"").splice(0,u).forEach(function(S,T){d+=parseInt(S)*(u+2-(T+1))}),p=d%11,p=p<2?0:11-p,p!==parseInt(e.substring(u,u+1))&&(t=!1)}),t}async function be(e){let t="Houve uma falha ao salvar seus dados. Tente novamente mais tarde.";try{let r=await fetch(`${X}/api:TJEuMepe/user/edit`,{...k([],"PUT"),body:Y(e)});if(!r.ok){let d=await r.json();return _.call(r,d?.message??t)}let u=await r.json();return D.call(r,u)}catch{return _(t)}}async function ve(){let e="Houve uma falha ao carregar seus dados. Tente novamente mais tarde.";try{let t=await fetch(`${X}/api:TJEuMepe/user/get`,{...k()});if(!t.ok){let u=await t.json();return _.call(t,u?.message??e)}let r=await t.json();return D.call(t,r)}catch{return _(e)}}ve().then(e=>{e.succeeded&&A(e.data)})})();})();
