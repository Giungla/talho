!function(){"use strict";var e="__Host-Talho-Session-Cookie",t="X-Talho-Session";function i(i){const s=i?.headers.get(t);s&&function(e,t,i={}){if(0===u(e))throw new Error("'setCookie' should receive a valid cookie name");if(!["string","number","boolean"].includes(typeof t)||0===u(t.toString()))throw new Error("'setCookie' should receive a valid cookie value");const s=[`${e}=${t}`];i?.expires&&i?.expires instanceof Date&&s.push("expires="+i.expires.toUTCString()),i.maxAge&&s.push(`maxAge=${i.maxAge}`),i?.sameSite&&"string"==typeof i?.sameSite&&s.push(`SameSite=${i?.sameSite}`),i?.path&&s.push(`path=${i?.path}`),i?.domain&&s.push(`domain=${i?.path}`),i?.httpOnly&&s.push("HttpOnly"),i?.secure&&s.push("Secure");const r=s.join(m);document.cookie=r}(e,s,{path:"/",secure:!0,sameSite:"Strict",expires:new Date(Date.now()+1e3*v*14)})}function s(e,t=!1){return i(this),t||this&&401===this.status&&(location.href=l("/acessos/entrar",{redirect_to:encodeURIComponent(location.pathname+location.search)})),{message:e,succeeded:!1}}function r(e){return i(this),{data:e,succeeded:!0}}function a(i=[],s="GET"){const r="application/json",a=new Headers({Accept:r,"Content-Type":r});for(const[e,t]of i)a.set(e,t);const n=y(e);n&&a.set(t,n);const o=y("__Host-Talho-AuthToken");return o&&a.set("Authorization",o),{method:s,headers:a}}var n=null;function o(e,t,i,s){if(e)return e.addEventListener(t,i,s),()=>e.removeEventListener(t,i,s)}function d(e){return i=!e,!!(t=function(e,t=document){return t?t.querySelector(e):n}("[data-wtf-loader]"))&&t.classList.toggle("oculto",i);var t,i}function l(e,t={}){const i=new URL(`${location.protocol}//${location.hostname}`),s=new URL(e,i);for(const[r,a]of Object.entries(t))s.searchParams.set(r,a);return s.toString()}function h(e){return JSON.stringify(e)}function c(e){return e.replace(/\D+/g,"")}function u(e){return e.length}function p(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function g(e){return e===n}var m="; ";function y(e){const t=document.cookie.split(m).find(t=>{const{name:i}=C(t);return i===e});return!!t&&C(t).value}function C(e){const[t,i]=e.split("=");return{name:t,value:i}}var v=86400,P=new Intl.NumberFormat("pt-BR",{currency:"BRL",style:"currency"});function b(e,t=0){const i=Math.pow(10,t);return Math.round(e*i)/i}var f="talho_cart_items",V={AC:"Acre",AL:"Alagoas",AP:"Amapá",AM:"Amazonas",BA:"Bahia",CE:"Ceará",DF:"Distrito Federal",ES:"Espírito Santo",GO:"Goiás",MA:"Maranhão",MT:"Mato Grosso",MS:"Mato Grosso do Sul",MG:"Minas Gerais",PA:"Pará",PB:"Paraíba",PR:"Paraná",PE:"Pernambuco",PI:"Piauí",RJ:"Rio de Janeiro",RN:"Rio Grande do Norte",RS:"Rio Grande do Sul",RO:"Rondônia",RR:"Roraima",SC:"Santa Catarina",SP:"São Paulo",SE:"Sergipe",TO:"Tocantins"},S=Object.keys(V),D="",E="https://xef5-44zo-gegm.b2.xano.io",{ref:A,createApp:w}=Vue,N="/",M="shipping",_="billing",$=`${E}/api:79PnTkh_`,F=`${E}/api:5lp3Lw8X`,R=`${E}/api:24B7O9Aj`,O="ERROR_CODE_NOT_FOUND",I="ERROR_CODE_BAD_REQUEST",k={[O]:"O CEP indicado não foi localizado.",[I]:"Não realizamos entregas na sua região."},H=document.currentScript?.getAttribute("data-public-key"),j=[10,11],B=new WeakMap,T=new Event("input"),x="same",G="diff",L="creditcard";function z(e,t){return Object.hasOwn(e,t)}function U(e){return e.trim()}function X(e,t,i){return e?t.push(i):-1}function q(e,t){return e.includes(t)}function Q(e,t){return e.test(t)}function J(...e){return{mounted(t){const i=o(t,"input",i=>{if(!i.isTrusted)return;const s=i.target;s.value=e.reduce((e,t)=>t(e),s.value??D),t.dispatchEvent(T)});B.set(t,i)},unmounted:K}}function W(e,t,i){return{field:e,valid:t,...i&&{ignoreIf:i}}}async function Z({cep:e,deliveryMode:t}){const i="Não foi possível encontrar o endereço";if(8!==u(e=c(e)))return s(i);try{const n=await fetch(`${E}/api:jyidAW68/cepaddress/${e}/checkout`,{...a([],"POST"),body:h({deliveryMode:t})});if(!n.ok){const e=await n.json();return s.call(n,e?.code??i)}const o=await n.json();return r.call(n,o)}catch(n){return s(i)}}var K=e=>{const t=B.get(e);t&&(t(),B.delete(e))};w({name:"TalhoCheckoutApp",setup:()=>({customerCPF:A(D),customerMail:A(D),customerPhone:A(D),customerBirthdate:A(D),customerCreditCardCVV:A(D),customerCreditCardDate:A(D),customerCreditCardNumber:A(D),customerCreditCardHolder:A(D),billingCEP:A(D),billingAddress:A(D),billingNumber:A(D),billingComplement:A(D),billingNeighborhood:A(D),billingCity:A(D),billingState:A(D),shippingRecipient:A(D),shippingCEP:A(D),shippingAddress:A(D),shippingNumber:A(D),shippingComplement:A(D),shippingNeighborhood:A(D),shippingCity:A(D),shippingState:A(D),couponCode:A(D),customerMailElement:A(n),customerCPFElement:A(n),customerPhoneElement:A(n),customerBirthdateElement:A(n),paymentMethodMessageElement:A(n),customerCreditCardCVVElement:A(n),customerCreditCardDateElement:A(n),customerCreditCardNumberElement:A(n),customerCreditCardHolderElement:A(n),billingCEPElement:A(n),billingAddressElement:A(n),billingNumberElement:A(n),billingNeighborhoodElement:A(n),billingCityElement:A(n),billingStateElement:A(n),deliveryPlaceMessageElement:A(n),shippingRecipientElement:A(n),shippingCEPElement:A(n),shippingAddressElement:A(n),shippingNumberElement:A(n),shippingNeighborhoodElement:A(n),shippingCityElement:A(n),shippingStateElement:A(n),deliveryDateMessageElement:A(n),deliveryHourMessageElement:A(n),installmentsMessageElement:A(n),couponCodeElement:A(n),deliveryPlaceAddressErrorMessage:A(n),deliveryBillingAddressErrorMessage:A(n),deliveryShippingAddressErrorMessage:A(n)}),data:()=>({user:n,errorMessage:n,hasPendingPayment:!1,isSubmitted:!1,productlist:n,visitedFields:[],selectedPayment:n,availablePayments:[{label:"Cartão de crédito",method:L},{label:"PIX",method:"pix"}],deliveryPlace:n,deliveryPlaces:[{token:x,label:"Mesmo endereço de cobrança do cartão"},{token:G,label:"Entregar em um endereço diferente"}],installment:n,selectedInstallment:n,isCouponPending:!1,coupon:n,isPagSeguroLoaded:!1,deliveryDate:n,deliveryHour:n,isDeliveryLoading:!1,deliveryPrice:n,deliveryOptions:n,priorityTax:n,subsidy:n,selectedBillingAddressId:n,selectedShippingAddressId:n}),created(){Promise.allSettled([this.getLoggedInUser().then(e=>{e.succeeded&&(this.user=e.data)}),this.refreshCart().then(()=>d(!1))]),window.addEventListener("storage",e=>{e.key===f&&this.refreshCart()})},methods:{setPreviousAddress(e,t){const i=this.user?.address_list.find(t=>t.id===e);if(!i)return;const{id:s,cep:r,address:a,number:n,city:o,complement:d,state:l,neighborhood:h}=i;this[`${t}CEP`]=r,this[`${t}Address`]=a,this[`${t}Number`]=n,this[`${t}Complement`]=d,this[`${t}City`]=o,this[`${t}State`]=l,this[`${t}Neighborhood`]=h,t!==M?t===_&&(this.selectedBillingAddressId=s):this.selectedShippingAddressId=s},async getLoggedInUser(){const e="Falha na captura do usuário";try{const t=await fetch(`${E}/api:TJEuMepe/user/checkout`,{...a([])});if(!t.ok){const i=await t.json();return s.call(t,i?.message??e,!0)}const i=await t.json();return r.call(t,i)}catch(t){return s(e)}},async getCart(){const e="Falha ao capturar os produtos";try{const t=await fetch(`${$}/cart/get`,{...a([])});if(!t.ok){const i=await t.json();return s.call(t,i?.message??e)}const i=await t.json();return r.call(t,i)}catch(t){return s(e)}},async refreshCart(){if(!this.hasPendingPayment)return this.getCart().then(e=>{e.succeeded&&(0!==u(e.data.items)?this.productlist=e.data:location.href=l("/",{reason:"empty_cart"}))})},async getInstallments(){const e="Falha ao capturar o parcelamento";try{const t=await fetch(`${F}/calculatefees`,{...a([],"POST"),body:h({amount:this.getOrderPrice,cardBin:this.customerCreditCardNumber.replace(/\D+/g,D).slice(0,8)})});if(!t.ok){const i=await t.json();return s.call(t,i?.message??e)}const i=await t.json();return r.call(t,i)}catch(t){return s(e)}},async refreshInstallments(){if(!this.isCreditCard||!this.isCreditCardGroupValid||this.getCreditCardToken.hasErrors)return;this.installment=n,this.selectedInstallment=n;const e=await this.getInstallments();e.succeeded&&(this.installment=e.data)},setSelectedInstallmentsCount(e){var t;this.selectedInstallment!==e&&(this.selectedInstallment=(t=e,Math.max(1,Math.min(2,t))))},setSelectedPaymentMethod(e){this.selectedPayment!==e&&(this.hasDeliveryDates||this.handleDeliveryOptions(),e!==L?this.clearCreditCardData():this.isPagSeguroLoaded||this.loadPagSeguro(),this.deliveryPlace=n,this.selectedPayment=e)},setVisitedField(e){return X(!q(this.visitedFields,e),this.visitedFields,e)},hasVisitRegistry(e){return q(this.visitedFields,e)},async handlePayment(e){if(e.preventDefault(),this.hasPendingPayment||this.isDeliveryLoading)return;if(this.triggerValidations(),!this.isSubmitted)return this.isSubmitted=!0,void Vue.nextTick(()=>this.handlePayment(e));const t=this.firstInvalidField;if(t)return i={block:"center",behavior:"smooth"},t.field.scrollIntoView(i),void("INPUT"===t.field.tagName&&setTimeout(()=>t.field.focus(),500));var i;this.hasPendingPayment=!d(!0);const s=await this.handlePostPayment(this.selectedPayment);if(!s.succeeded)return this.errorMessage=s.message,void(this.hasPendingPayment=!d(!1));const r={pix:"pix",creditcard:"confirmacao-do-pedido"}[this.selectedPayment];location.href=l(["/pagamento",r].join(N),{order:s.data.transactionid}),localStorage.removeItem(f)},async handlePostPayment(e){const t="Falha ao gerar o pedido";try{const i=await fetch(`${F}/payment/process/${e}`,{...a([],"POST"),body:h({...this.getOrderBaseData,customer:{...this.getParsedCustomer,...this.getParsedAddresses},...e===L&&this.creditCardAdditionalInfo})});if(!i.ok){const e=await i.json();return s.call(i,e?.message??t)}const n=await i.json();return r.call(i,n)}catch(i){return s(t)}},triggerValidations(){const e=this.notIgnoredFields;for(const{field:t}of e)t?.dispatchEvent(new Event("blur"))},feedAddress(e,{uf:t,bairro:i,logradouro:s,localidade:r}){if(e===_)return this.billingAddress=s,this.billingNeighborhood=i,this.billingCity=r,void(this.billingState=t);this.shippingAddress=s,this.shippingNeighborhood=i,this.shippingCity=r,this.shippingState=t},setDeliveryPlace(e){this.deliveryPlace!==e&&(e===x&&/^\d{5}\-\d{3}$/.test(this.billingCEP)&&this.isBillingAddressGroupValid?Z({cep:this.billingCEP,deliveryMode:!0}).then(e=>{e.succeeded||(this.deliveryPlaceAddressErrorMessage=k?.[e.message]??e.message)}):this.deliveryPlaceAddressErrorMessage=n,this.deliveryPlace=e)},async captureAddress(e,t,i){if(!Q(/^\d{5}-\d{3}$/,t)||t===i)return!1;const s=`${e}CEP`,r=await Z({cep:t,deliveryMode:e===M});if(!r.succeeded){const{message:t}=r;return this[s]=D,this.setVisitedField(s),this.deliveryShippingAddressErrorMessage=e===M&&t!==O?k?.[t]??k[I]:n,this.deliveryBillingAddressErrorMessage=e===_&&t!==O?k?.[t]??k[I]:n,!1}switch(e){case M:this.deliveryShippingAddressErrorMessage=n;break;case _:this.deliveryBillingAddressErrorMessage=n}return this.feedAddress(e,r.data),!0},async captureCoupon(){const e="Falha ao capturar o cupom indicado";try{const t=await fetch(`${F}/get_coupon`,{...a([],"POST"),body:h({verify_amount:!0,coupon_code:this.couponCode,cpf:this.customerCPF&&n,has_subsidy:this.subsidy?.has??!1,delivery_cep:this.getParsedAddresses.shippingaddress.zipPostalCode,has_selected_delivery:!g(this.deliveryHour)&&!g(this.deliveryDate)})});if(!t.ok){const i=await t.json();return s.call(t,i?.message??e)}const i=await t.json();return r.call(t,i)}catch(t){return s(e)}},async handleSearchCoupon(){if(this.isCouponPending)return;this.isCouponPending=!0;const e=await this.captureCoupon();this.isCouponPending=!1,e.succeeded?this.coupon=e.data:this.coupon={error:!0,message:e.message}},handleRemoveCoupon(){this.coupon=n,this.couponCode=D},loadPagSeguro(){const e=document.createElement("script");e.async=!0,e.src="https://assets.pagseguro.com.br/checkout-sdk-js/rc/dist/browser/pagseguro.min.js",e.onload=()=>{this.isPagSeguroLoaded=!0},document.head.appendChild(e)},clearCreditCardData(){this.customerCreditCardHolder=D,this.customerCreditCardNumber=D,this.customerCreditCardDate=D,this.customerCreditCardCVV=D},async handleDeliveryOptions(){const e=await this.captureDeliveryOptions();e.succeeded&&(this.deliveryOptions=e.data)},async captureDeliveryOptions(){const e="Falha ao capturar as opções de entrega";try{const t=await fetch(`${R}/delivery`,{...a([])});if(!t.ok){const i=await t.json();return s.call(t,i?.message??e)}const i=await t.json();return r.call(t,i)}catch(t){return s(e)}},setDeliveryDate(e){const t=this.deliveryOptions?.dates?.find(({shift_days:t})=>t===e);t&&this.deliveryDate!==e&&(this.deliveryDate=t.shift_days,this.deliveryHour=n,this.deliveryPrice=n)},setDeliveryHour(e){this.deliveryHour!==e&&0!==this.getSelectedDateDetails?.periods.periods_count&&(this.deliveryHour=e)},async handleDeliveryQuotation(e){this.isDeliveryLoading=!0;const t=await this.captureDeliveryQuotation(e);if(!t.succeeded)return;const{total:i,validator:s}=t.data;this.deliveryPrice={value:i,validator:s},this.isDeliveryLoading=!1},async captureDeliveryQuotation(e){const t="Falha ao gerar uma cotação";try{const i=await fetch(`${E}/api:i6etHc7G/site/checkout-delivery`,{...a([],"POST"),signal:e.signal,body:h(this.quotationPayload)});if(!i.ok){const e=await i.json();return s.call(i,e?.message??t)}const n=await i.json();return r.call(i,n)}catch(i){return s(t)}},async handleSubsidy(){const e=this.getParsedAddresses.shippingaddress.zipPostalCode;if(!/^\d{5}\-\d{3}$/.test(e))return;const t=await this.verifyForSubsidy(c(e));this.subsidy=t.succeeded?t.data:n},async verifyForSubsidy(e){const t="Houve uma falha na verificação";try{const i=await fetch(`${R}/delivery/${e}/subsidy`,{...a([])});if(!i.ok){const e=await i.json();return s.call(i,e?.message??t)}const n=await i.json();return r.call(i,n)}catch(i){return s(t)}}},computed:{hasSelectedPaymentMethod(){return!g(this.selectedPayment)},isCreditCard(){return this.selectedPayment===L},getOrderSubtotal(){return this.productlist?.order_price??0},getOrderSubtotalFormatted(){return P.format(this.getOrderSubtotal)},getOrderPrice(){const e=[this.getOrderSubtotal,this.getShippingPrice,this.priorityFee,this.subsidyDiscountPrice,this.getCouponDiscountPrice];return X(this.hasPIXDiscount,e,this.PIXDiscountPrice),b(e.reduce((e,t)=>e+t,0),2)},getOrderPriceFormatted(){return P.format(this.getOrderPrice)},getShippingPrice(){return this.hasFreeShippingByCartPrice||g(this.deliveryPrice)?0:this.deliveryPrice.value/100},getShippingPriceFormatted(){return this.hasFreeShippingByCartPrice?"Frete grátis":P.format(this.getShippingPrice)},getCouponDiscountPrice(){if(this.hasNullCoupon||this.hasInvalidCoupon)return 0;const{value:e,is_percentage:t}=this.coupon,i=this.getParsedPriceForApplyDiscount;let s=t?Math.min(e/100,1)*(-1*i):-1*Math.min(i,e);return Math.round(100*Math.abs(s))/100*Math.sign(s)},getCouponDiscountPriceFormatted(){return P.format(this.getCouponDiscountPrice)},getParsedPriceForApplyDiscount(){if(this.hasNullCoupon||this.hasInvalidCoupon)return 0;const{cupom_type:e}=this.coupon,{getShippingPrice:t}=this;return e===M&&this.hasSubsidy?Math.max(t+this.subsidyDiscountPrice,0):{product_id:0,shipping:t,subtotal:this.getOrderSubtotal}[e]},getParsedProducts(){const e=this.productlist?.items;return e?e.map(({name:e,imageUrl:t,quantity:i,price:s})=>({name:e,image:t,quantity:i,price:P.format(s),finalPrice:P.format(s*i),imageStyle:`background-image: url('${t}')`})):[]},isPersonalDataValid(){return!this.isSubmitted||[this.customerMailValidation.valid,this.customerBirthdateValidation.valid,this.customerCPFValidation.valid,this.customerPhoneValidation.valid].every(Boolean)},customerMailValidation(){return W(this.customerMailElement,!this.hasVisitRegistry("customerMail")||Q(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,this.customerMail))},customerBirthdateValidation(){const{customerBirthdate:e}=this;return W(this.customerBirthdateElement,!this.hasVisitRegistry("customerBirthdate")||Q(/^\d{2}\/\d{2}\/\d{4}$/,e)&&function(e){const[t,i,s]=e.split(N);return"Invalid Date"!==new Date(`${s}-${i}-${t}T00:00:00`).toString()}(e))},customerCPFValidation(){const{customerCPF:e}=this;return W(this.customerCPFElement,!this.hasVisitRegistry("customerCPF")||Q(/^\d{3}\.\d{3}\.\d{3}-\d{2}$/,this.customerCPF)&&function(e){if(11!==u(e=c(e))||/^(\d)\1{10}$/.test(e))return!1;const t=j.map((t,i)=>{const s=i?10:9,r=11-[...e.slice(0,s)].map(Number).reduce((e,i,s)=>e+i*(t-s),0)%11;return r>9?0:r});return e.endsWith(t.join(D))}(e))},customerPhoneValidation(){return W(this.customerPhoneElement,!this.hasVisitRegistry("customerPhone")||Q(/\(\d{2}\)\s\d{4,5}-\d{4}/,this.customerPhone))},paymentMethodValidation(){return W(this.paymentMethodMessageElement,!g(this.selectedPayment))},customerCreditCardHolderValidation(){return W(this.customerCreditCardHolderElement,!this.hasVisitRegistry("customerCreditCardHolder")||/^(\w{2,})(\s+(\w+))+$/.test(p(U(this.customerCreditCardHolder).replace(/\s{2,}/g," "))),!this.isCreditCard)},customerCreditCardNumberValidation(){return W(this.customerCreditCardNumberElement,!this.hasVisitRegistry("customerCreditCardNumber")||Q(/^(\d{4})(\s\d{4}){2}(\s\d{3,4})$/,U(this.customerCreditCardNumber)),!this.isCreditCard)},customerCreditCardDateValidation(){const{customerCreditCardDate:e}=this;return W(this.customerCreditCardDateElement,!this.hasVisitRegistry("customerCreditCardDate")||Q(/^(1[012]|0[1-9])\/\d{2}$/,e)&&function(e){const t=e.split(N);if(2!==u(t))return!1;const[i,s]=t,r=parseInt(i,10),a=parseInt(s,10);if(isNaN(r)||isNaN(a)||r<1||r>12)return!1;const n=new Date;return new Date(2e3+(a<100?a:0),r,0,23,59,59)>n}(e),!this.isCreditCard)},customerCreditCardCVVValidation(){return W(this.customerCreditCardCVVElement,!this.hasVisitRegistry("customerCreditCardCVV")||Q(/^\d{3}$/,this.customerCreditCardCVV),!this.isCreditCard)},isCreditCardGroupValid(){return[this.customerCreditCardHolderValidation.valid,this.customerCreditCardNumberValidation.valid,this.customerCreditCardDateValidation.valid,this.customerCreditCardCVVValidation.valid].every(Boolean)},billingCEPValidation(){return W(this.billingCEPElement,!this.hasVisitRegistry("billingCEP")||Q(/^\d{5}-\d{3}$/,this.billingCEP),!this.isCreditCard)},billingAddressValidation(){return W(this.billingAddressElement,!this.hasVisitRegistry("billingAddress")||u(U(this.billingAddress))>2,!this.isCreditCard)},billingNumberValidation(){return W(this.billingNumberElement,!this.hasVisitRegistry("billingNumber")||u(this.billingNumber)>0,!this.isCreditCard)},billingNeighborhoodValidation(){return W(this.billingNeighborhoodElement,!this.hasVisitRegistry("billingNeighborhood")||u(this.billingNeighborhood)>0,!this.isCreditCard)},billingCityValidation(){return W(this.billingCityElement,!this.hasVisitRegistry("billingCity")||u(this.billingCity)>2,!this.isCreditCard)},billingStateValidation(){return W(this.billingStateElement,!this.hasVisitRegistry("billingState")||q(S,this.billingState),!this.isCreditCard)},isBillingAddressGroupValid(){return g(this.deliveryBillingAddressErrorMessage)&&[this.billingCEPValidation,this.billingAddressValidation,this.billingNumberValidation,this.billingNeighborhoodValidation,this.billingCityValidation,this.billingStateValidation].every(e=>e.valid)},deliveryPlaceValidation(){return W(this.deliveryPlaceMessageElement,this.hasSelectedAddress&&g(this.deliveryPlaceAddressErrorMessage),!this.isCreditCard)},shippingRecipientValidation(){return W(this.shippingRecipientElement,!this.hasVisitRegistry("shippingRecipient")||Q(/^(\w{2,})(\s+(\w+))+$/,p(U(this.shippingRecipient)).replace(/\s{2,}/g," ")),!this.shouldValidateShippingAddress)},shippingCEPValidation(){return W(this.shippingCEPElement,!this.hasVisitRegistry("shippingCEP")||Q(/^\d{5}-\d{3}$/,this.shippingCEP),!this.shouldValidateShippingAddress)},shippingAddressValidation(){return W(this.shippingAddressElement,!this.hasVisitRegistry("shippingAddress")||u(U(this.shippingAddress))>2,!this.shouldValidateShippingAddress)},shippingNumberValidation(){return W(this.shippingNumberElement,!this.hasVisitRegistry("shippingNumber")||u(U(this.shippingNumber))>0,!this.shouldValidateShippingAddress)},shippingNeighborhoodValidation(){return W(this.shippingNeighborhoodElement,!this.hasVisitRegistry("shippingNeighborhood")||u(U(this.shippingNeighborhood))>3,!this.shouldValidateShippingAddress)},shippingCityValidation(){return W(this.shippingCityElement,!this.hasVisitRegistry("shippingCity")||u(U(this.shippingCity))>2,!this.shouldValidateShippingAddress)},shippingStateValidation(){return W(this.shippingStateElement,!this.hasVisitRegistry("shippingState")||q(S,this.shippingState),!this.shouldValidateShippingAddress)},isShippingAddressGroupValid(){return g(this.deliveryShippingAddressErrorMessage)&&[this.shippingCEPValidation,this.shippingAddressValidation,this.shippingNumberValidation,this.shippingNeighborhoodValidation,this.shippingCityValidation,this.shippingStateValidation].every(e=>e.valid)},deliveryDatesGroupValidation(){return W(this.deliveryDateMessageElement,!g(this.deliveryDate),!this.paymentMethodValidation.valid)},deliveryHoursGroupValidation(){return W(this.deliveryHourMessageElement,!g(this.deliveryHour),!this.deliveryDatesGroupValidation.valid)},installmentGroupValidation(){return W(this.installmentsMessageElement,!g(this.selectedInstallment),!this.isCreditCard||!this.paymentMethodValidation.valid)},notIgnoredFields(){return[this.customerMailValidation,this.customerBirthdateValidation,this.customerCPFValidation,this.customerPhoneValidation,this.paymentMethodValidation,this.customerCreditCardHolderValidation,this.customerCreditCardNumberValidation,this.customerCreditCardDateValidation,this.customerCreditCardCVVValidation,this.billingCEPValidation,this.billingAddressValidation,this.billingNumberValidation,this.billingNeighborhoodValidation,this.billingCityValidation,this.billingStateValidation,this.deliveryPlaceValidation,this.shippingRecipientValidation,this.shippingCEPValidation,this.shippingAddressValidation,this.shippingNumberValidation,this.shippingNeighborhoodValidation,this.shippingCityValidation,this.shippingStateValidation,this.deliveryDatesGroupValidation,this.deliveryHoursGroupValidation,this.installmentGroupValidation].filter(({ignoreIf:e})=>q([!1,void 0],e))},firstInvalidField(){return this.notIgnoredFields.find(({valid:e})=>!e)??n},hasSelectedAddress(){return!g(this.deliveryPlace)},isSameAddress(){return this.deliveryPlace===x},isDiffAddress(){return this.deliveryPlace===G},shouldValidateShippingAddress(){return!this.isCreditCard||this.showShippingAddressSelector&&!this.isSameAddress},showShippingAddressSelector(){return!this.isCreditCard||this.isCreditCard&&this.hasSelectedAddress},getParsedAddresses(){const e=e=>V?.[e]??D,t=e=>U(e).replace(/-+/g,D)||"N/A",i={zipPostalCode:this.shippingCEP,street:this.shippingAddress,number:this.shippingNumber,complement:t(this.shippingComplement),neighbourhood:this.shippingNeighborhood,city:this.shippingCity,state:e(this.shippingState)},s={zipPostalCode:this.billingCEP,street:this.billingAddress,number:this.billingNumber,complement:t(this.billingComplement),neighbourhood:this.billingNeighborhood,city:this.billingCity,state:e(this.billingState)};return this.isCreditCard?{billingaddress:s,shippingaddress:this.isSameAddress?s:i}:{shippingaddress:i,billingaddress:i}},getParsedCustomer(){return{name:this.isCreditCard?this.customerCreditCardHolder:this.shippingRecipient,cpf:this.customerCPF,email:this.customerMail,birthDate:this.customerBirthdate,phone:this.customerPhone}},getParsedDeliveryData(){const{getSelectedHourDetails:e,getSelectedDateDetails:t}=this;return{delivery_hour:{value:this.deliveryHour,validator:e?.validator,has_priority:e?.has_priority},delivery_date:{value:this.deliveryDate,validator:t?.validator,has_priority:t?.has_priority}}},getOrderBaseData(){return{user_id:n,coupon_code:this.hasInvalidCoupon||this.hasNullCoupon?n:this.coupon?.code,delivery:{...this.getParsedDeliveryData,delivery_price:this.deliveryPrice}}},showInstallmentSection(){return this.isCreditCard&&u(this.installment??[])>0},getParsedInstallments(){const{installment:e}=this;return e?e.map(({installments:e,installment_value:t})=>({installments:e,installment_value:P.format(t)})):[]},hasNullCoupon(){return g(this.coupon)},hasAppliedCoupon(){return z(this.coupon??{},"cupom_type")},hasInvalidCoupon(){return z(this.coupon??{},"error")},isCouponCodeValid(){const{couponCode:e}=this;return u(U(e))>4&&!Q(/[^A-Z\d]/,e)},getCreditCardToken(){if(!this.isPagSeguroLoaded)return{errors:[],hasErrors:!1,encryptedCard:n};const[e,t]=this.customerCreditCardDate.split(N);return window.PagSeguro.encryptCard({expMonth:e,expYear:"20".concat(t),holder:this.customerCreditCardHolder,securityCode:this.customerCreditCardCVV,number:c(this.customerCreditCardNumber),publicKey:H})},hasDeliveryDates(){const{deliveryOptions:e}=this;return t=e?.dates,Array.isArray(t)&&u(e?.dates)>0;var t},hasDeliveryHour(){return!g(this.deliveryDate)&&u(this.getParsedDeliveryHours)>0},getParsedDeliveryHours(){return!this.hasDeliveryDates||g(this.getSelectedDateDetails)?[]:this.getSelectedDateDetails.periods.hours.map(({label:e,hour:t})=>({hour:t,label:e}))},quotationPayload(){if([this.deliveryDate,this.deliveryHour].some(e=>g(e)))return!1;const e=this.getParsedAddresses.shippingaddress.zipPostalCode;if(!/^\d{5}\-\d{3}$/.test(e))return!1;const{delivery_hour:t,delivery_date:i}=this.getParsedDeliveryData;return{cep:e,delivery_hour:t,delivery_date:i}},getParsedDeliveryDates(){if(g(this.deliveryOptions))return[];const e=this.deliveryDate;return this.deliveryOptions.dates.map(({label:t,shift_days:i})=>({label:t,shift_days:i,selected:e===i}))},getSelectedDateDetails(){if(!this.deliveryDate===n)return n;const e=this.deliveryOptions?.dates.find(({shift_days:e})=>e===this.deliveryDate);return e||n},getSelectedHourDetails(){return this.getSelectedDateDetails&&this.deliveryHour?this.getSelectedDateDetails.periods.hours.find(({hour:e})=>e===this.deliveryHour)??n:n},hasPriorityFee(){return!!(this.hasDeliveryHour&&this.getSelectedDateDetails&&this.getSelectedHourDetails)&&this.getSelectedDateDetails.has_priority&&this.getSelectedHourDetails.has_priority},priorityFee(){return this.hasPriorityFee?this.deliveryOptions?.priority_fee:0},priorityFeeFormatted(){return P.format(this.priorityFee)},hasSubsidy(){return!0===this.subsidy?.has&&this.getShippingPrice>0},subsidyDiscountPrice(){return!0===this.subsidy?.has?-1*Math.min(this.subsidy.value,this.getShippingPrice):0},subsidyDiscountPriceFormatted(){return P.format(this.subsidyDiscountPrice)},hasFreeShippingByCartPrice(){return this.getOrderSubtotal>=400},creditCardAdditionalInfo(){const{installment:e,isSameAddress:t,getCreditCardToken:i,selectedInstallment:s,customerCreditCardHolder:r}=this;return{is_same_address:t,credit_card_info:{holderName:r,creditCardToken:i.encryptedCard??D,numberOfPayments:s,installmentValue:e?.find(({installments:e})=>e===s)?.installment_value??0}}},hasPIXDiscount(){return"pix"===this.selectedPayment&&(this.deliveryOptions?.pix_discount??0)>0},PIXDiscountPrice(){return this.hasPIXDiscount?b((this.deliveryOptions?.pix_discount??0)/100*-this.getOrderSubtotal,2):0},PIXDiscountPriceFormatted(){return P.format(this.PIXDiscountPrice)},userAddresses(){const e=this.user;return e&&0!==u(e.address_list)?e.address_list.map(({address:e,number:t,cep:i,...s})=>({...s,address:e,number:t,cep:i,complete:`${e}, ${t} ${i}`})):[]}},watch:{billingCEP(e,t){this.captureAddress(_,e,t).then(e=>{e&&(this.deliveryPlaceAddressErrorMessage=n,this.deliveryPlace===x&&(this.deliveryPlace=n))})},shippingCEP(e,t){this.deliveryDate=n,this.deliveryHour=n,this.captureAddress(M,e,t)},getOrderPrice:{immediate:!0,handler:function(){this.refreshInstallments()}},getCreditCardToken(e){e.hasErrors||this.refreshInstallments()},quotationPayload(e,t,i){if(!e)return;const{cep:s,delivery_hour:r,delivery_date:a}=e;if(!/^\d{5}\-\d{3}$/.test(s))return;const n=new AbortController;if(!t)return this.handleDeliveryQuotation(n),i(()=>n.abort());const{cep:o,delivery_date:d,delivery_hour:l}=t;return this.handleDeliveryQuotation(n),i(()=>n.abort())},getParsedAddresses(e,t){e&&t&&e.shippingaddress.zipPostalCode!==t.shippingaddress.zipPostalCode&&/^\d{5}\-\d{3}$/.test(e.shippingaddress.zipPostalCode)&&(this.isCreditCard&&g(this.deliveryPlace)||this.handleSubsidy())},user(e){e&&(this.customerPhone=e.telephone??"",this.customerCPF=e.cpf??"",this.customerBirthdate=e.birthday?.split("-").reverse().join("/")??"",this.customerMail=e.email??"")}},directives:{maskDate:J(c,function(e){return e.replace(/^(\d{0,2})(\d{0,2})(\d{0,4})/,(e,t,i,s)=>[t,i,s].filter(Boolean).join(N))}),maskCpf:J(c,function(e){return e.replace(/^(\d{0,3})(\d{0,3})(\d{0,3})(\d{0,2})/,(e,t,i,s,r)=>{const a=[];return X(t,a,`${t}`),X(i,a,`.${i}`),X(s,a,`.${s}`),X(r,a,`-${r}`),a.join(D)})}),maskPhone:J(c,function(e){const t=(e,t,i,s)=>{const r=[];return X(t,r,`(${t}`),X(i,r,`) ${i}`),X(s,r,`-${s}`),r.join(D)};return u(e)<11?e.replace(/^(\d{0,2})(\d{0,4})(\d{0,4})/,t):e.replace(/^(\d{0,2})(\d{0,5})(\d{0,4})/,t)}),maskCreditCard:J(c,function(e){return e.replace(/^(\d{0,4})(\d{0,4})(\d{0,4})(\d{0,4})/,(e,t,i,s,r)=>{const a=[];for(const n of[t,i,s,r])X(n,a,n);return a.join(" ")})}),maskCreditCardDate:J(c,function(e){return e.replace(/^(\d{0,2})(\d{0,2})/,(e,t,i)=>{const s=[];for(const r of[t,i])X(r,s,r);return s.join(N)})}),maskNumberOnly:J(c),maskCep:J(c,function(e){return e.replace(/^(\d{0,5})(\d{0,3})/,(e,t,i)=>{const s=[];for(const r of[t,i])X(r,s,r);return s.join("-")})}),upperCase:J(function(e){return e.toUpperCase()}),normalize:J(p),visitedField:{mounted(e,{value:t,instance:i}){const s=o(e,"blur",()=>{i.setVisitedField(t),B.delete(e)},{once:!0});B.set(e,s)},unmounted:K}}}).mount("#fechamentodopedido"),window.addEventListener("pageshow",e=>{e.persisted&&window.location.reload()})}();