!function(){"use strict";var e="__Host-Talho-Session-Cookie",t="X-Talho-Session";function r(r){const o=r?.headers.get(t);o&&function(e,t,r={}){if(0===i(e))throw new Error("'setCookie' should receive a valid cookie name");if(!["string","number","boolean"].includes(typeof t)||0===i(t.toString()))throw new Error("'setCookie' should receive a valid cookie value");const o=[`${e}=${t}`];r?.expires&&r?.expires instanceof Date&&o.push("expires="+r.expires.toUTCString()),r.maxAge&&o.push(`maxAge=${r.maxAge}`),r?.sameSite&&"string"==typeof r?.sameSite&&o.push(`SameSite=${r?.sameSite}`),r?.path&&o.push(`path=${r?.path}`),r?.domain&&o.push(`domain=${r?.path}`),r?.httpOnly&&o.push("HttpOnly"),r?.secure&&o.push("Secure");const s=o.join(c);document.cookie=s}(e,o,{path:"/",secure:!0,sameSite:"Strict",expires:new Date(Date.now()+1e3*p*14)})}function o(e){return r(this),this&&401===this.status&&(location.href=function(e,t={}){const r=new URL(`${location.protocol}//${location.hostname}`),o=new URL(e,r);for(const[s,n]of Object.entries(t))o.searchParams.set(s,n);return o.toString()}("/acessos/entrar",{redirect_to:encodeURIComponent(location.pathname+location.search)})),{message:e,succeeded:!1}}function s(e){return r(this),{data:e,succeeded:!0}}function n(r=[],o="GET"){const s="application/json",n=new Headers({Accept:s,"Content-Type":s});for(const[e,t]of r)n.set(e,t);const a=d(e);a&&n.set(t,a);const i=d("__Host-Talho-AuthToken");return i&&n.set("Authorization",i),{method:o,headers:n}}var a=null;function i(e){return e.length}var c="; ";function d(e){const t=document.cookie.split(c).find(t=>{const{name:r}=u(t);return r===e});return!!t&&u(t).value}function u(e){const[t,r]=e.split("=");return{name:t,value:r}}var p=86400,{createApp:h}=Vue,l="transactionid",m="pix",f="creditcard",y={[m]:"PIX",[f]:"Cartão de crédito"},_="https://xef5-44zo-gegm.b2.xano.io/api:YomXpzWs";h({name:"TalhoOrderNoteApp",setup:()=>({}),data:()=>({order:a,prepare_status:a,prepareMessage:a}),async created(){const e=new URLSearchParams(location.search).get(l);if(!e)return;const t=await this.getOrder(e);t.succeeded&&(this.order=t.data,this.prepare_status=t.data.order.prepare_status)},methods:{async getOrder(e){const t="Não foi possível encontrar o pedido";try{const r=await fetch(`${_}/order/delivery-prepare?${l}=${e}`,{...n()});if(!r.ok){const e=await r.json();return o.call(r,e?.message??t)}const a=await r.json();return s.call(r,a)}catch(r){return o(t)}},async handleOrderStatus(){const e=this.order;if(!e)return;const t=await this.setOrderStatus(e.order.number,this.prepare_status);this.prepareMessage=t.succeeded?"Modificado com sucesso":t.message},async setOrderStatus(e,t){const r="Não foi possível alterar o status de preparação";try{const i=await fetch(`${_}/order/delivery-status`,{...n([],"PATCH"),body:(a={order_id:e,prepare_status:t},JSON.stringify(a))});if(!i.ok){const e=await i.json();return o.call(i,e?.message??r)}const c=await i.json();return s.call(i,c)}catch(i){return o(r)}var a},printPage(){window.print()}},computed:{company(){return this.order?.company??a},customer(){return this.order?.customer??a},items(){return this.order?.items??a},itemsCount(){return i(this.items??[])},cOrder(){if(!this.order)return a;const{date:e,time:t,total:r,number:o,shipping:s,subtotal:n,discounts:i,change_for:c,notes_short:d,observations:u,payment_method:p}=this.order.order;return{date:e,time:t,total:r,number:o,shipping:s,subtotal:n,discounts:i,change_for:c,notes_short:d,observations:u,payment_method:y?.[p]}},deliveryDate(){if(!this.order)return a;const{order:e}=this.order;return`${e.delivery_date} ${e.delivery_hour}`},priorityTax(){const e=this.order?.order;return e&&e.has_priority?e?.priority_price:a},subsidyDiscount(){const e=this.order?.order;return e&&e.has_subsidy?e?.subsidy_price:a},pixDiscount(){const e=this.order?.order;return e&&"pix"===e.payment_method?{discountPrice:e.pix_discount_price,discountPercentual:e.pix_discount_percentual}:a},hasPaid(){return this.order?.order.paid??!1},deliveredAt(){return this.order?.order.delivered_at??a}},watch:{},directives:{}}).mount("#note-order"),window.addEventListener("pageshow",e=>{e.persisted&&window.location.reload()})}();