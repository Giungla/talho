(()=>{let l="oculto",n="talho_cart_items",a=null,i="https://xef5-44zo-gegm.b2.xano.io/api:79PnTkh_",c={headers:{Accept:"application/json","Content-Type":"application/json"}},f=new Intl.NumberFormat("pt-BR",{currency:"BRL",style:"currency"});var t={cart:a,fetched:a,isPending:!1,isCartOpened:!0};let g=new Proxy(t,{get(t,e){switch(e){case"hasFreeShipping":return 400<(t.cart?.order_price??0);case"missingForFreeShipping":return Math.max(0,400-(t.cart?.order_price??0));case"getOrderPrice":return f.format(t.cart?.order_price??0);default:return Reflect.get(t,e)}},set(t,e,a){var r,t=Reflect.set(t,e,a);if(t)switch(e){case"isPending":break;case"isCartOpened":k();break;case"cart":(()=>{if(b(h,g.getOrderPrice),y(g.cart?.items)&&m&&p){if(O(v("[data-wtf-floating-cart-total-block]"),l,0===P(g.cart?.items)),O(v("[data-wtf-floating-cart-checkout-button]",F),l,0===P(g.cart?.items)),!O(w,l,0<P(g.cart?.items)))return b(v("[data-wtf-floating-cart-items-indicator]"),"0"),p.replaceChildren();let t=0;var e,r,n,i,c,o,s=document.createDocumentFragment();for({slug:e,imageUrl:r,quantity:n,price:i,sku_id:c,name:o}of g.cart.items){t+=n;var d=m.cloneNode(!0),u=(b(v("[data-wtf-floating-cart-item-product-name]",d),o),b(v("[data-wtf-floating-cart-item-quantity]",d),n.toString()),b(v("[data-wtf-floating-cart-item-product-price]",d),f.format(i)),v("[data-wtf-floating-cart-item-image]",d));u&&(u.style.backgroundImage=`url('${r}')`);let a={sku_id:c,reference_id:e};for(let[e,t]of[["delete","data-wtf-floating-cart-item-remove"],["increase","data-wtf-floating-cart-item-plus-button"],["decrease","data-wtf-floating-cart-item-minus-button"]])((t,e,a,r)=>{if(t)t.addEventListener(e,a,r)})(v(`[${t}]`,d),"click",t=>C.call(t,e,a));s.appendChild(d)}b(v("[data-wtf-floating-cart-items-indicator]"),t.toString()),p?.replaceChildren(s)}})(),r=g.hasFreeShipping,O(o,l,!r),O(s,l,r),r?b(v("[data-wtf-promo-validada-txt-sem-imagem]",o),"Você ganhou frete grátis"):b(v("[data-wtf-promo-invalidada-txt]",s),`Adicione mais ${f.format(g.missingForFreeShipping)} e ganhe frete grátis`),localStorage.setItem(n,JSON.stringify(a))}return t}}),m=v("[data-wtf-floating-cart-item]"),p=v("[data-wtf-floating-cart-item-wrapper]"),w=v("[data-wtf-floating-cart-empty-cart]"),o=v("[data-wtf-promo-valid]"),s=v("[data-wtf-promo-invalid]"),h=v("[data-wtf-floating-cart-total]");function r(t,e,a){return Object.prototype.hasOwnProperty.call(t,e)&&(!a||typeof t[e]===a)}function y(t){return Array.isArray(t)}function d(t){if("string"!=typeof t)return a;try{return JSON.parse(t)}catch{return a}}function v(t,e=document){return e?e.querySelector(t):a}function b(t,e){t&&(t.textContent=e)}function O(t,e,a){return t&&t.classList.toggle(e,a)}function P(t){return t.length}function u(t){return{message:t,succeeded:!1}}function S(t){return{data:t,succeeded:!0}}async function k(){var t,e;g.isCartOpened&&((t=d(localStorage.getItem(n)))&&r(e=t,"order_price","number")&&r(e,"items")&&y(e.items)&&(0===P(e.items)||e.items.every(t=>r(t,"name","string")&&r(t,"quantity","number")&&r(t,"price","number")&&r(t,"imageUrl","string")&&r(t,"sku_id","number")&&r(t,"slug","string")))?(g.fetched??=!0,g.cart=t):(localStorage.removeItem(n),g.isPending=!0,e=await(async()=>{var e="Houve uma falha ao buscar o seu carrinho";try{var t=await fetch(i+"/cart/get",{...c,credentials:"include"});return t.ok?S(await t.json()):u((await t.json())?.message??e)}catch(t){return u(e)}})(),g.fetched??=!0,g.isPending=!1,e.succeeded&&(g.cart=e.data)))}async function _(t,e){g.isPending||(g.isPending=!0,e=await(async(t,e)=>{var a="Houve uma falha ao buscar o seu carrinho";try{var r=await fetch(i+"/cart/handle",{...c,method:"POST",credentials:"include",body:JSON.stringify({item:t,operation:e})});return r.ok?S(await r.json()):u((await r.json())?.message??a)}catch(t){return u(a)}})({...e,quantity:1},t),g.isPending=!1,e.succeeded&&(g.cart=e.data))}async function C(t,e){this.preventDefault(),this.stopPropagation(),await _(t,e)}let F=v("[data-wtf-floating-cart]");t=new MutationObserver(t=>{var e,t=t[0].target,t=(e="carrinhoflutuante--visible",!!(t=t)&&t.classList.contains(e));g.isCartOpened=t,window.scrollTo({top:0,behavior:"instant"}),document.body.style.overflow=t?"hidden":"unset"}),F&&(t.observe(F,{attributes:!0,attributeFilter:["class"]}),p)&&(window.addEventListener("storage",function(t){t.key===n&&(g.cart=t.newValue?d(t.newValue):a)}),k().then(()=>{g.isCartOpened=!1}))})();