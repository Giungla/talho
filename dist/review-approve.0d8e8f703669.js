(function(){'use strict';var $=401,v="__Host-Talho-AuthToken",_="__Host-Talho-Session-Cookie",h="X-Talho-Session";function F(e){!e||e.status!==$||(location.href=O("/acessos/entrar",{redirect_to:encodeURIComponent(location.pathname)}));}function D(e){let r=e?.headers.get(h);r&&b(_,r,{path:"/",secure:true,sameSite:"Strict",expires:new Date(Date.now()+C(90))});}function l(e){return D(this),F(this),{message:e,succeeded:false}}function S(e){return D(this),{data:e,succeeded:true}}function R(e=[],r="GET"){let t=new Headers({Accept:"application/json","Content-Type":"application/json"});for(let[p,d]of e)t.set(p,d);let o=E(_);o&&t.set(h,o);let a=E(v);return a&&t.set("Authorization",a),{method:r,headers:t}}var H=null,f="oculto";function c(e,r=document){return r?r.querySelector(e):H}function I(e,r,t,o){if(e)return e.addEventListener(r,t,o),()=>e.removeEventListener(r,t,o)}function m(e,...r){e&&e.classList.remove(...r);}function y(e,r){e&&(e.textContent=typeof r=="string"?r:r.toString());}function O(e,r={}){let t=new URL(`${location.protocol}//${location.hostname}`),o=new URL(e,t);for(let[a,p]of Object.entries(r))o.searchParams.set(a,p);return o.toString()}function L(e){return JSON.stringify(e)}function T(e){return e.length}var w="; ";function E(e){let r=document.cookie.split(w).find(t=>{let{name:o}=N(t);return o===e});return r?N(r).value:false}function N(e){let[r,t]=e.split("=");return {name:r,value:t}}function b(e,r,t={}){if(T(e)===0)throw new Error("'setCookie' should receive a valid cookie name");if(!["string","number","boolean"].includes(typeof r)||T(r.toString())===0)throw new Error("'setCookie' should receive a valid cookie value");let o=[`${e}=${r}`];t?.expires&&t?.expires instanceof Date&&o.push("expires="+t.expires.toUTCString()),t.maxAge&&o.push(`maxAge=${t.maxAge}`),t?.sameSite&&typeof t?.sameSite=="string"&&o.push(`SameSite=${t?.sameSite}`),t?.path&&o.push(`path=${t?.path}`),t?.domain&&o.push(`domain=${t?.path}`),t?.httpOnly&&o.push("HttpOnly"),t?.secure&&o.push("Secure");let a=o.join(w);return document.cookie=a,a}function C(e){return 86400*1e3*e}var U="https://xef5-44zo-gegm.b2.xano.io";(function(){let e=`${U}/api:9ixgU7Er/ratings`,t=new URLSearchParams(location.search).get("review_id"),o=c("[data-wtf-error-review]"),a=c("[data-wtf-approve-review]"),p=c("[data-wtf-approve-review-cta]"),d=c("[data-wtf-reprove-review]");if(!t)return m(o,f),g(o,"Nenhuma review informada");function x(n){if(n)return n.remove()}function g(n,i){n&&y(c("div",n),i);}async function q({reviewId:n,action:i}){let s="N\xE3o foi poss\xEDvel alterar a situa\xE7\xE3o da avalia\xE7\xE3o";try{let u=await fetch(`${e}/${n}/${i}`,{...R([],"PATCH"),body:L({})});if(!u.ok){let j=await u.json();return l.call(u,j?.message??s)}let A=await u.json();return S.call(u,A)}catch{return l(s)}}async function G(n){let i="Houve uma falha com a captura da avalia\xE7\xE3o";try{let s=await fetch(`${e}/${n}/get`,{...R([],"GET")});if(!s.ok){let A=await s.json();return l.call(s,A?.message??i)}let u=await s.json();return S.call(s,u)}catch{return l(i)}}async function K(n,i){return q({action:i,reviewId:n}).then(s=>(s.succeeded?(m(a,f),g(a,s.data.message)):(m(o,f),g(o,s.message)),s))}function P(n,i,s){x(n),I(i,"click",async u=>{u.stopPropagation(),(await K(k,s)).succeeded&&x(i);});}let k=parseInt(t);G(k).then(n=>{if(!n.succeeded){for(let i of [p,d,a])x(i);return m(o,f),g(o,n.message)}if(y(c("[data-wtf-provided-review]"),n.data.text),n.data.is_approved)return P(p,d,"reject");P(d,p,"approve");});})();
})();