!function(){"use strict";function e(e){const r=document.cookie.split("; ").find(r=>{const{name:a}=t(r);return a===e});return!!r&&t(r).value}function t(e){const[t,r]=e.split("=");return{name:t,value:r}}var r="__Host-Talho-Session-Cookie",a="X-Talho-Session";function n(e){const t=e?.headers.get(a);t&&function(e,t,r={}){if(0===u(e))throw new Error("'setCookie' should receive a valid cookie name");if(!["string","number","boolean"].includes(typeof t)||0===u(t.toString()))throw new Error("'setCookie' should receive a valid cookie value");const a=[`${e}=${t}`];d(r?.expires&&r?.expires instanceof Date,a,"expires="+r.expires.toUTCString()),d(r.maxAge,a,`maxAge=${r.maxAge}`),d(r?.sameSite&&"string"==typeof r?.sameSite,a,`SameSite=${r?.sameSite}`),d(r?.path,a,`path=${r?.path}`),d(r?.domain,a,`domain=${r?.domain}`),d(r?.httpOnly,a,"HttpOnly"),d(r?.secure,a,"Secure");const n=a.join("; ");document.cookie=n}(r,t,{path:"/",secure:!0,sameSite:"Strict",expires:new Date(Date.now()+1e3*c*14)})}function s(e,t=!1){return n(this),t||this&&401===this.status&&(location.href=function(e,t={}){const r=new URL(`${location.protocol}//${location.hostname}`),a=new URL(e,r);for(const[n,s]of Object.entries(t))a.searchParams.set(n,s);return a.toString()}("/acessos/entrar",{redirect_to:encodeURIComponent(location.pathname+location.search)})),{message:e,succeeded:!1}}function o(e){return n(this),{data:e,succeeded:!0}}function i(t=[],n="GET"){const s="application/json",o=new Headers({Accept:s,"Content-Type":s});for(const[e,r]of t)o.set(e,r);const i=e(r);i&&o.set(a,i);const c=e("__Host-Talho-AuthToken");return c&&o.set("Authorization",c),{method:n,headers:o}}var c=86400,l=new Intl.NumberFormat("pt-BR",{currency:"BRL",style:"currency"});function u(e){return e.length}function d(e,t,r){return e?t.push(r):-1}new Event("input"),new Event("blur");var{createApp:h}=Vue;h({name:"OrderManagementApp",async created(){const e=await this.getOrders();e.succeeded&&(this.orders=e.data)},data:()=>({orders:null,activeFilter:null,availableFilters:[{label:"Em preparação",name:"PREPARING"},{label:"Preparado",name:"PREPARED"},{label:"Pronto para entrega",name:"DELIVERYREADY"},{label:"Entregue",name:"COMPLETED"}]}),methods:{async getOrders(){const e="Houve uma falha com a busca de pedidos";try{const t=await fetch("https://xef5-44zo-gegm.b2.xano.io/api:YomXpzWs/order/list",{...i()});if(!t.ok){const r=await t.json();return s.call(t,r?.message??e)}const r=await t.json();return o.call(t,r)}catch(t){return s(e)}},applyFilter(e){this.activeFilter!==e&&(this.activeFilter=e)},getFilterByToken(e){return this.getAppliableFilters.find(({name:t})=>t===e)}},computed:{hasOrders(){const{orders:e}=this;return Array.isArray(e)&&e.length>0},getParsedOrders(){if(!this.hasOrders)return[];const{orders:e,activeFilter:t}=this;return(null!==t?e.filter(({prepare_status:e,status:r})=>e===t||r===t):e).map(({total:e,transaction_id:t,created_at:r,order_items:a,prepare_status:n,status:s,...o})=>{const i=[s,n].find(Boolean);return{...o,created_date:(c=r,new Date(c).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),items_count:a,price:l.format(e/100),url:`/adm/ficha-de-pedido?transactionid=${t}`,...i&&{delivery_status:this.getFilterByToken(i)}};var c})??[]},getAppliableFilters(){if(!this.hasOrders)return[];const{getAvailableStatus:e}=this;return this.availableFilters.reduce((t,r)=>e.includes(r.name)?t.concat({...r,className:r.name.toLowerCase()}):t,[])},getAvailableStatus(){if(!this.hasOrders)return[];const e=[];for(const{prepare_status:t,status:r}of this.orders)d(t&&!e.includes(t),e,t),d(r&&!e.includes(r),e,r);return e}}}).mount("#order-management-list"),window.addEventListener("pageshow",e=>{e.persisted&&window.location.reload()})}();