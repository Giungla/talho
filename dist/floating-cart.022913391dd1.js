"use strict";(()=>{var L="; ";function S(t){let e=document.cookie.split(L).find(r=>{let{name:n}=w(r);return n===t});return e?w(e).value:!1}function w(t){let[e,r]=t.split("=");return{name:e,value:r}}function y(t,e,r={}){if(t.length===0)throw new Error("'setCookie' should receive a valid cookie name");if(!["string","number","boolean"].includes(typeof e)||e.toString().length===0)throw new Error("'setCookie' should receive a valid cookie value");let n=[`${t}=${e}`];r?.expires&&r?.expires instanceof Date&&n.push("expires="+r.expires.toUTCString()),r.maxAge&&n.push(`maxAge=${r.maxAge}`),r?.sameSite&&typeof r?.sameSite=="string"&&n.push(`SameSite=${r?.sameSite}`),r?.path&&n.push(`path=${r?.path}`),r?.domain&&n.push(`domain=${r?.path}`),r?.httpOnly&&n.push("HttpOnly"),r?.secure&&n.push("Secure");let i=n.join(L);return document.cookie=i,i}var P="__Host-Talho-AuthToken",C="__Host-Talho-Session-Cookie",A="X-Talho-Session";function m(t){let e=this?.get(A);return e&&y(C,e,{path:"/",secure:!0,sameSite:"Strict",expires:new Date(Date.now()+R(90))}),{message:t,succeeded:!1}}function T(t){let e=this?.get(A);return e&&y(C,e,{path:"/",secure:!0,sameSite:"Strict",expires:new Date(Date.now()+R(90))}),{data:t,succeeded:!0}}function x(t=[],e="GET"){let r=new Headers({Accept:"application/json","Content-Type":"application/json"});for(let[f,I]of t)r.set(f,I);let n=S(C);n&&r.set(A,n);let i=S(P);return i&&r.set("Authorization",i),{method:e,headers:r}}function R(t){return 86400*1e3*t}var h=new Intl.NumberFormat("pt-BR",{currency:"BRL",style:"currency"});var u=null,p="oculto";function _(t){return Array.isArray(t)}function o(t,e=document){return e?e.querySelector(t):u}function M(t,e,r,n){if(t)return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function v(t,e){return t?t.classList.contains(e):!1}function l(t,e,r){return t?t.classList.toggle(e,r):!1}function s(t,e){t&&(t.textContent=typeof e=="string"?e:e.toString())}function N(t){return JSON.stringify(t)}function b(t){if(typeof t!="string")return null;try{return JSON.parse(t)}catch{return u}}function g(t){return t.length}var E="talho_cart_items";var k={AC:"Acre",AL:"Alagoas",AP:"Amap\xE1",AM:"Amazonas",BA:"Bahia",CE:"Cear\xE1",DF:"Distrito Federal",ES:"Esp\xEDrito Santo",GO:"Goi\xE1s",MA:"Maranh\xE3o",MT:"Mato Grosso",MS:"Mato Grosso do Sul",MG:"Minas Gerais",PA:"Par\xE1",PB:"Para\xEDba",PR:"Paran\xE1",PE:"Pernambuco",PI:"Piau\xED",RJ:"Rio de Janeiro",RN:"Rio Grande do Norte",RS:"Rio Grande do Sul",RO:"Rond\xF4nia",RR:"Roraima",SC:"Santa Catarina",SP:"S\xE3o Paulo",SE:"Sergipe",TO:"Tocantins"},Z=Object.keys(k),Q=Object.values(k);var K="https://xef5-44zo-gegm.b2.xano.io";var tt="carrinhoflutuante--visible",V=`${K}/api:79PnTkh_`,et={cart:u,fetched:u,isPending:!1,isCartOpened:!0},a=new Proxy(et,{get(t,e){switch(e){case"hasFreeShipping":return(t.cart?.order_price??0)>400;case"missingForFreeShipping":return Math.max(0,400-(t.cart?.order_price??0));case"getOrderPrice":return h.format(t.cart?.order_price??0);default:return Reflect.get(t,e)}},set(t,e,r){let n=Reflect.set(t,e,r);if(!n)return n;switch(e){case"isPending":break;case"isCartOpened":j();break;case"cart":ct(),ut(),localStorage.setItem(E,JSON.stringify(r));break}return n}}),G=o("[data-wtf-floating-cart-item]"),O=o("[data-wtf-floating-cart-item-wrapper]"),rt=o("[data-wtf-floating-cart-empty-cart]"),q=o("[data-wtf-promo-valid]"),U=o("[data-wtf-promo-invalid]"),nt=o("[data-wtf-floating-cart-total]");function c(t,e,r){return Object.prototype.hasOwnProperty.call(t,e)&&(!r||typeof t[e]===r)}function ot(t){return!c(t,"order_price","number")||!c(t,"items")||!_(t.items)?!1:g(t.items)===0?!0:t.items.every(e=>c(e,"name","string")&&c(e,"quantity","number")&&c(e,"price","number")&&c(e,"imageUrl","string")&&c(e,"sku_id","number")&&c(e,"slug","string"))}async function j(){if(!a.isCartOpened)return;let t=b(localStorage.getItem(E));if(t&&ot(t)){a.fetched??=!0,a.cart=t;return}else localStorage.removeItem(E);a.isPending=!0;let e=await at();a.fetched??=!0,a.isPending=!1,e.succeeded&&(a.cart=e.data)}async function at(){let t="Houve uma falha ao buscar o seu carrinho";try{let e=await fetch(`${V}/cart/get`,{...x()});if(!e.ok){let n=await e.json();return m.call(e.headers,n?.message??t)}let r=await e.json();return T.call(e.headers,r)}catch{return m(t)}}async function st(t,e){let r="Houve uma falha ao buscar o seu carrinho";try{let n=await fetch(`${V}/cart/handle`,{...x([],"POST"),body:N({item:t,operation:e})});if(!n.ok){let f=await n.json();return m.call(n.headers,f?.message??r)}let i=await n.json();return T.call(n.headers,i)}catch{return m(r)}}async function it(t,e){if(a.isPending)return;a.isPending=!0;let r=await st({...e,quantity:1},t);a.isPending=!1,r.succeeded&&(a.cart=r.data)}function ct(){s(nt,a.getOrderPrice);let t=a.cart?.items;if(!_(t)||!G||!O)return;if(l(o("[data-wtf-floating-cart-total-block]"),p,g(t)===0),l(o("[data-wtf-floating-cart-checkout-button]",D),p,g(t)===0),!l(rt,p,g(t)>0))return s(o("[data-wtf-floating-cart-items-indicator]"),"0"),O.replaceChildren();let e=0,r=document.createDocumentFragment();for(let{slug:n,imageUrl:i,quantity:f,price:I,sku_id:$,name:z}of t){e+=f;let d=G.cloneNode(!0);s(o("[data-wtf-floating-cart-item-product-name]",d),z),s(o("[data-wtf-floating-cart-item-quantity]",d),f.toString()),s(o("[data-wtf-floating-cart-item-product-price]",d),h.format(I));let F=o("[data-wtf-floating-cart-item-image]",d);F&&(F.style.backgroundImage=`url('${i}')`);let B={sku_id:$,reference_id:n},J=[["delete","data-wtf-floating-cart-item-remove"],["increase","data-wtf-floating-cart-item-plus-button"],["decrease","data-wtf-floating-cart-item-minus-button"]];for(let[Y,X]of J)M(o(`[${X}]`,d),"click",W=>pt.call(W,Y,B));r.appendChild(d)}s(o("[data-wtf-floating-cart-items-indicator]"),e.toString()),O?.replaceChildren(r)}function ut(){let{hasFreeShipping:t}=a;return l(q,p,!t),l(U,p,t),t?s(o("[data-wtf-promo-validada-txt-sem-imagem]",q),"Voc\xEA ganhou frete gr\xE1tis"):s(o("[data-wtf-promo-invalidada-txt]",U),`Adicione mais ${h.format(a.missingForFreeShipping)} e ganhe frete gr\xE1tis`)}async function pt(t,e){this.preventDefault(),this.stopPropagation(),await it(t,e)}var D=o("[data-wtf-floating-cart]"),lt=new MutationObserver(t=>{let e=t[0].target,r=v(e,tt);a.isCartOpened=r,window.scrollTo({top:0,behavior:"instant"}),document.body.style.overflow=r?"hidden":"unset"});D&&(lt.observe(D,{attributes:!0,attributeFilter:["class"]}),O&&(window.addEventListener("storage",function(t){t.key===E&&(a.cart=t.newValue?b(t.newValue):u)}),j().then(()=>{a.isCartOpened=!1})));})();
