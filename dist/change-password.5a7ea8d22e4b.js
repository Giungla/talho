"use strict";(()=>{(function(){let f="oculto",S="__Host-Talho-AuthToken",_="mensagemdeerro",l="disabled",H="https://xef5-44zo-gegm.b2.xano.io",h="[data-wtf-wrapper]",R={preventScroll:!1};function o(e,t=document){return t?t.querySelector(e):null}function v(e,t,n,r){if(e)return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function M(e){let t=document.cookie.split("; ").find(n=>{let{name:r}=b(n);return r===e});return t?b(t).value:!1}function b(e){let[t,n]=e.split("=");return{name:t,value:n}}function p(e){g(o("[data-wtf-loader]"),f,!e)}function I(){return M(S)!==!1}if(!I()){let e=encodeURIComponent(location.pathname);location.href=`/acessos/entrar?redirect_to=${e}`;return}function k(e,t,n){e&&e.setAttribute(t,n)}function m(e,t){e&&e.removeAttribute(t)}function K(e,...t){e&&e.classList.add(...t)}function N(e,...t){e&&e.classList.remove(...t)}function g(e,t,n){return e?e.classList.toggle(t,n):!1}function q(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function D(e){return e.length}function L(e){return{message:e,succeeded:!1}}function $(e){return{data:e,succeeded:!0}}function j(e,t){if(!e)return;let n=!t.succeeded,r=o("[data-wtf-error-update-password]",e),s=o("[data-wtf-success-update-password]",e);if(r&&g(r,f,!n),s&&g(s,f,n),!n){s&&setTimeout(()=>K(s,f),8e3);return}let a=r&&o("div",r);a&&(a.textContent=t.message)}function P(e){return function(t){return[e,t]}}function y(e,t){let n=e.closest(h);n&&g(n,_,!t)}function A(e,t){e&&e.focus(t)}async function U(e){let t="Houve uma falha ao atualizar sua senha. Por favor, tente novamente mais tarde.";try{let n=await fetch(`${H}/api:TJEuMepe/user/change-password`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:M(S)},body:JSON.stringify(e)});if(!n.ok){let s=await n.json();return L(s?.message??t)}let r=await n.json();return $(r)}catch{return L(t)}}let d=o("#wf-form-update-password"),z=["name","method","data-name","aria-label","data-wf-page-id","data-wf-element-id","data-turnstile-sitekey"];if(d){for(let t of z)m(d,t);let e=d.parentElement;N(e,"w-form"),d.remove(),e.insertAdjacentHTML("afterbegin",d.outerHTML)}let u=o("[data-wtf-password]"),c=o("[data-wtf-confirm-password]");function V(e){return t=>t.test(e)}let C=[{field:u,validator:J},{field:c,validator:F}];for(let{field:e,validator:t}of C)e&&(v(e,"blur",t),v(e,"input",()=>y(e,!0)));function B(e){let t=V(e);return{hasNumber:t(/\d/),hasLowercase:t(/[a-z]/),hasUppercase:t(/[A-Z]/),hasMinLength:t(/.{8,}/),hasSpecialChar:t(/[!@#$%^&*()_+{}\[\]:;<>,.?\/~\\-]/)}}function G({hasNumber:e,hasLowercase:t,hasUppercase:n,hasMinLength:r,hasSpecialChar:s}){let a=(T,w)=>`Sua senha deve conter pelo menos ${T} ${w}`;return r?e?s?t?n?!1:a(1,"letra mai\xFAscula"):a(1,"letra min\xFAscula"):a(1,"caractere especial"):a(1,"n\xFAmero"):a(8,"caracteres")}function x(e,t){if(!e)return;let n=o("[data-wtf-field-error] div",e.closest(h));n&&(n.textContent=t)}function O(e,t){return e&&t&&e?.value===t?.value}function J(){let e=P("wtfPassword");if(!u)return e(!1);let{hasNumber:t,hasMinLength:n,hasLowercase:r,hasUppercase:s,hasSpecialChar:a}=B(u.value),T=t&&r&&s&&a&&n,w=G({hasNumber:t,hasLowercase:r,hasUppercase:s,hasMinLength:n,hasSpecialChar:a});return x(u,w||""),y(u,T),D(c?.value??"")>0&&O(u,c)&&F(),e(T)}function F(){let e=P("wtfConfirmPassword"),t=O(u,c);return x(c,t?"":"As senhas informadas n\xE3o conferem"),c&&y(c,t),e(t)}let i=o("#wf-form-update-password"),E=o('[type="submit"]',i);m(E,l),i&&(v(i,"submit",async e=>{e.preventDefault(),e.stopPropagation(),k(E,l,l);let t=C.map(({validator:r})=>r).find(r=>r().at(1)===!1);if(t){let r=q(t().at(0)),s=o(`[data-${r}]`,i);return A(s,R),setTimeout(()=>{s?.dispatchEvent(new FocusEvent("blur")),A(s,R)},0),m(E,l)}p(!0);let n=await U({password:i?.password.value,confirm_password:i?.confirm_password.value});if(j(i,n),m(E,l),!n.succeeded)return p(!1);i.reset(),p(!1)}),p(!1))})();})();
