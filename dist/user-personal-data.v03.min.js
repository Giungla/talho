(()=>{let s="oculto";var a;let P="mensagemdeerro",u="https://xef5-44zo-gegm.b2.xano.io";function i(e,a=document){return a.querySelector(e)}function n(e,a,t,n){e.addEventListener(a,t,n)}function t(e){var[e,a]=e.split("=");return{name:e,value:a}}function e(e,a){e.removeAttribute(a)}function o(e,...a){e.classList.add(...a)}function r(e,...a){e.classList.remove(...a)}function c(e,a,t){e.classList.toggle(a,t)}function l(e){return{message:e,succeeded:!1}}function f(){window.location.href="/acessos/entrar?redirect_to="+encodeURIComponent(location.pathname)}function d(e,a){e&&(c(e,s,!a),e.textContent=a??"")}function p(e){if(Object.assign(v,e),z){var a,t;n(z,"click",()=>{L&&r(L,s),o(z,s)},{once:!0});for([a,t]of[[k,v.cpf],[b,v.name],[j,v.birthday],[T,v.telephone],[y,v.last_name]])((e,a)=>{e&&(e.value=a??"")})(a,t);r(z,s),L&&o(L,s)}}let v=new Proxy({cpf:"",name:"",email:"",birthday:"",telephone:"",isFormVisible:!1},{get(e,a){var t=Reflect.get(e,a);return"fullName"!==a?t:e?.name+" "+e?.last_name},set(e,a,t,n){e=Reflect.set(e,a,t);switch(a){case"name":case"last_name":d(F,n?.fullName??"");break;case"birthday":d(S,t);break;case"telephone":d(J,t);break;case"cpf":d(R,t);break;case"email":d(I,t);break;case"points":d(O,t);break;case"isFormVisible":console.log("form estarÃ¡ visivel: ",t)}return e}}),m={Accept:"application/json","Content-Type":"application/json",Authorization:(a="__Host-Talho-AuthToken",!!(h=document.cookie.split("; ").find(e=>{e=t(e).name;return e===a}))&&t(h).value)};var w=i("#wf-form-update-user-data");if(w){for(var M of["name","method","data-name","aria-label","data-wf-page-id","data-wf-element-id","data-turnstile-sitekey"])e(w,M);var h=w.parentElement,$=i('[type="submit"]',w);$&&e($,"disabled"),r(h,"w-form"),w.remove(),h.insertAdjacentHTML("beforeend",w.outerHTML)}let g=i("#wf-form-update-user-data"),O=(n(g,"submit",async a=>{a.preventDefault(),a.stopPropagation();a=g,t="cpf";var a=a.hasOwnProperty(t),t=[H,Z,q,B],t=(a&&t.splice(2,0,V),t.find(e=>!1===e().at(1)));if(t)i(`[data-${t().at(0).replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}]`,g)?.focus({preventScroll:!1});else{t={birthday:(j?.value??"").split("/").reverse().join("-"),name:b?.value,telephone:T?.value,last_name:y?.value},a=(a&&Object.assign(t,{cpf:k?.value}),await(async e=>{var a="Houve uma falha ao salvar seus dados. Tente novamente mais tarde.";try{var t,n=await fetch(u+"/api:TJEuMepe/user/edit",{method:"PUT",headers:m,body:JSON.stringify(e)});return n.ok?{succeeded:!0,data:await n.json()}:(t=await n.json(),401===n.status&&f(),l(t?.message??a))}catch(e){return l(a)}})(t));{t=g;var n=a;var r=!n.succeeded,d=i("[data-wtf-user-update-error-message]",t);let e=i("[data-wtf-user-update-success-message]",t);d&&c(d,s,!r),e&&c(e,s,r),r?(t=d&&i("div",d))&&(t.textContent=n.message):setTimeout(()=>e&&o(e,s),8e3)}a.succeeded&&p(a.data)}}),i("[data-wtf-score]")),F=i("[data-wtf-name]"),I=i("[data-wtf-email]"),J=i("[data-wtf-phone]"),R=i("[data-wtf-cpf]"),S=i("[data-wtf-birthday]"),b=i("[data-wtf-name-update]"),y=i("[data-wtf-last-name-update]"),T=i("[data-wtf-phone-update]"),k=i("[data-wtf-cpf-update]"),j=i("[data-wtf-birthday-update]"),z=i("[data-wtf-edit-account-data]"),L=i("[data-wtf-update-account-data]");for(let{field:e,validator:a}of[{field:b,validator:H},{field:y,validator:Z},{field:k,validator:V},{field:T,validator:q},{field:j,validator:B}])e&&(n(e,"blur",a),n(e,"input",()=>x(e,!0)));function N(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function A(e){e=C(e);return{cleaned:e,size:_(e)}}function U(e){return e.trim().replace(/\s+/g," ")}function _(e){return e.length}function C(e){return e.replace(/\D/g,"")}function E(a){return function(e){return[a,e]}}function x(e,a){e=e.closest("[data-wtf-wrapper]");e&&c(e,P,!a)}function D(e){return/^[a-zA-Z\s]+$/.test(e)}function H(){var e,a=E("wtfNameUpdate");return b?(e=1<_(e=U(N(b.value)))&&D(e),x(b,e),a(e)):a(!1)}function Z(){var e,a=E("wtfLastNameUpdate");return y?(e=0<_(e=U(N(y.value)))&&D(e),x(y,e),a(e)):a(!1)}function V(){var e,a=E("wtfCpfUpdate");return k?(e=/^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(k.value)&&(a=>{if(11!==_(a=C(a))||/^(\d)\1{10}$/.test(a))return!1;let r=!0;return[9,10].forEach(function(t){let n=0,e;a.split("").splice(0,t).forEach(function(e,a){n+=parseInt(e)*(t+2-(a+1))}),((e=n%11)<2?0:11-e)!==parseInt(a.substring(t,t+1))&&(r=!1)}),r})(k.value),x(k,e),a(e)):a(!1)}function q(){var e,a=E("wtfPhoneUpdate");return T?(e=/^\(\d{2}\)\s\d{4,5}-\d{4}$/.test(T.value),x(T,e),a(e)):a(!1)}function B(){var e,a,t,n,r=E("wtfBirthdayUpdate");return j?(a=j.value,e=/^(\d{2})\/(\d{2})\/(19|20)(\d{2})$/g.test(a),[a,n,t]=a.split("/"),t=new Date(t+`-${n}-${a}T00:00:00.000Z`).getTime(),n=e&&!isNaN(t)&&Date.now()>t,x(j,n),r(n)):r(!1)}T&&n(T,"input",()=>{T.value=(e=>{var{cleaned:e,size:a}=A(e);return 0===a?e:0<a&&a<3?e.replace(/(\d{0,2})/,"($1"):a<7?e.replace(/(\d{2})(\d{0,4})/,"($1) $2"):a<=10?e.replace(/(\d{2})(\d{4})(\d{1,4})/,"($1) $2-$3"):e.replace(/(\d{2})(\d{5})(\d{4})/,"($1) $2-$3")})(T.value)}),k&&n(k,"input",()=>{k.value=(e=>{var{cleaned:e,size:a}=A(e);return a<4?e:a<7?e.replace(/(\d{3})(\d{1,3})/,"$1.$2"):a<=9?e.replace(/(\d{3})(\d{3})(\d{1,3})/,"$1.$2.$3"):e.replace(/(\d{3})(\d{3})(\d{3})(\d{1,2})/,"$1.$2.$3-$4")})(k.value)}),j&&n(j,"input",()=>{j.value=(e=>{var{cleaned:e,size:a}=A(e);return a<3?e:a<5?e.replace(/(\d{2})(\d{1,2})/,"$1/$2"):e.replace(/(\d{2})(\d{2})(\d{1,4})/,"$1/$2/$3")})(j.value)}),(async()=>{var a="Houve uma falha ao carregar seus dados. Tente novamente mais tarde.";try{var e,t=await fetch(u+"/api:TJEuMepe/user/get",{headers:m});return t.ok?{succeeded:!0,data:await t.json()}:(e=await t.json(),401===t.status&&f(),l(e?.message??a))}catch(e){return l(a)}})().then(e=>{e.succeeded&&p(e.data)})})();