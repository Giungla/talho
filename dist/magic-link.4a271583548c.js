"use strict";(()=>{(function(){"use strict";let i="__Host-Talho-AuthToken",s="/area-do-usuario/pedidos-de-compra",f="oculto";function c(t,n=document){return n.querySelector(t)}function m(t,n,e={}){if(t.length===0)throw new Error("'setCookie' should receive a valid cookie name");if(!["string","number","boolean"].includes(typeof n)||n.toString().length===0)throw new Error("'setCookie' should receive a valid cookie value");let o=[`${t}=${n}`];e?.expires&&e?.expires instanceof Date&&o.push("expires="+e.expires.toUTCString()),e?.sameSite&&typeof e?.sameSite=="string"&&o.push(`SameSite=${e?.sameSite}`),e?.path&&o.push(`path=${e?.path}`),e?.domain&&o.push(`domain=${e?.path}`),e?.httpOnly&&o.push("HttpOnly"),e?.secure&&o.push("Secure");let r=o.join("; ");return document.cookie=r,r}function g(t){let n=document.cookie.split("; ").find(e=>{let{name:o}=u(e);return o===t});return n?u(n).value:!1}function u(t){let[n,e]=t.split("=");return{name:n,value:e}}function h(){return!!g(i)}if(h()){location.href=s;return}function p(t,...n){t&&t.classList.remove(...n)}function l(t){return{message:t,succeeded:!1}}function S(t){return{data:t,succeeded:!0}}async function E(t){let n="Houve uma falha ao validar o token. Por favor, tente novamente mais tarde.";try{let e=await fetch("https://xef5-44zo-gegm.b2.xano.io/api:uImEuFxO/auth/magic-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({magic_token:t})});if(!e.ok){let r=await e.json();return l(r?.message??n)}let o=await e.json();return S(o)}catch{return l(n)}}let k=new URLSearchParams(location.search),a=c("[data-wtf-recover-access-general-error-message]"),d=k.get("token");d&&E(d).then(t=>{if(!t.succeeded){let e=a&&c("div",a);p(a,f),e&&(e.textContent=t.message);return}m(i,t.data.authToken,{path:"/",secure:!0,sameSite:"Strict",expires:new Date(t.data.expiration)}),location.href=s})})();})();
