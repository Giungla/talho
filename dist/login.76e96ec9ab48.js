"use strict";(()=>{(function(){"use strict";let T="__Host-Talho-AuthToken",u="disabled",v="oculto",M="mensagemdeerro",C="/area-do-usuario/pedidos-de-compra",P="redirect_to",R="https://xef5-44zo-gegm.b2.xano.io",L="[data-wtf-general-error-message]",B={block:"center",behavior:"smooth"},m={preventScroll:!1};function d(e,t,n,o){if(e)return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function s(e,t=document){return t?t.querySelector(e):null}function W(e,t){e.scrollIntoView(t)}function k(e,t,n={}){if(e.length===0)throw new Error("'setCookie' should receive a valid cookie name");if(!["string","number","boolean"].includes(typeof t)||t.toString().length===0)throw new Error("'setCookie' should receive a valid cookie value");let o=[`${e}=${t}`];n?.expires&&n?.expires instanceof Date&&o.push("expires="+n.expires.toUTCString()),n?.sameSite&&typeof n?.sameSite=="string"&&o.push(`SameSite=${n?.sameSite}`),n?.path&&o.push(`path=${n?.path}`),n?.domain&&o.push(`domain=${n?.path}`),n?.httpOnly&&o.push("HttpOnly"),n?.secure&&o.push("Secure");let r=o.join("; ");return document.cookie=r,r}function I(e){let t=document.cookie.split("; ").find(n=>{let{name:o}=S(n);return o===e});return t?S(t).value:!1}function S(e){let[t,n]=e.split("=");return{name:t,value:n}}function U(){return!!I(T)}function l(e){return{message:e,succeeded:!1}}function y(e){return{data:e,succeeded:!0}}async function H(e){let t="Houve uma falha ao realizar o login. Por favor, tente novamente mais tarde.";try{let n=await fetch(`${R}/api:t3reRXiD/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){let r=await n.json();return l(r?.message??t)}let o=await n.json();return y(o)}catch{return l(t)}}async function F(){let e="Houve uma falha na autoriza\xE7\xE3o Google. Por favor, tente novamente mais tarde.",t=new URL(`${R}/api:h_RKfex8/oauth/google/init`);t.searchParams.set("redirect_uri",location.origin.concat("/acessos/google-social-login"));try{let n=await fetch(t);if(!n.ok){let r=await n.json();return l(r?.message??e)}let o=await n.json();return y(o)}catch{return l(e)}}function x(e){return e.length}function D(e,...t){e&&e.classList.add(...t)}function N(e,...t){e&&e.classList.remove(...t)}function A(e,t,n){return e?e.classList.toggle(t,n):!1}function K(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function p(e,t){e&&e.removeAttribute(t)}function E(e,t){e&&e.focus(t)}function w(){let t=new URL(location.href).searchParams.get(P);return t?decodeURIComponent(t):C}if(U()){location.href=w();return}let f=s("#wf-form-login"),$=["name","method","aria-label","data-wf-page-id","data-wf-element-id","data-turnstile-sitekey"];if(f){for(let t of $)p(f,t);let e=f.parentNode;N(e,"w-form"),f.remove(),e.insertAdjacentHTML("afterbegin",f.outerHTML)}let i=s("#wf-form-login"),O=new URLSearchParams(location.search),a=s("[data-wtf-user]"),c=s("[data-wtf-password]"),g=s('[type="submit"]',i),G=s("[data-wtf-google]");O.has("email")?(a&&(a.value=O.get("email")??""),E(c,m)):E(a,m);function _(e){return function(t){return[e,t]}}function h(e,t){if(!e)return;let n=e.closest("[data-wtf-wrapper]");n&&A(n,M,!t)}function j(e){e&&D(s(L,e),v)}function q(e,t){let n=!t.succeeded,o=s(L,e);if(A(o,v,!n),!n)return;let r=o&&s("div",o);r&&(r.textContent=t.message)}function z(){let e=_("wtfUser");if(!a)return e(!1);let t=/^(([\p{L}\p{N}!#$%&'*+\/=?^_`{|}~-]+(\.[\p{L}\p{N}!#$%&'*+\/=?^_`{|}~-]+)*)|("[\p{L}\p{N}\s!#$%&'*+\/=?^_`{|}~.-]+"))@(([a-zA-Z0-9]+(-[a-zA-Z0-9]+)*\.)+[a-zA-Z]{2,63}|(\[(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\]))$/u.test(a.value);return h(a,t),e(t)}function V(){let e=_("wtfPassword");if(!c)return e(!1);let t=x(c.value)>7;return h(c,t),e(t)}d(G,"click",function(e){e.preventDefault(),F().then(t=>{t.succeeded&&(location.href=t.data.authUrl)})},{once:!0});let b=[{field:a,validator:z},{field:c,validator:V}];for(let{field:e,validator:t}of b)d(e,"blur",t),d(e,"input",()=>h(e,!0));if(!i){console.warn("[WithTheFlow] Form was not founded at this page");return}d(i,"submit",async e=>{g?.setAttribute(u,u),e.preventDefault(),e.stopPropagation(),j(i);let n=b.map(({validator:r})=>r).find(r=>r().at(1)===!1);if(n){let r=K(n().at(0));return E(s(`[data-${r}]`,i),m),p(g,u)}let o=await H({email:a?.value,password:c?.value});if(o.succeeded){k(T,o.data.authToken,{path:"/",secure:!0,sameSite:"Strict",expires:new Date(o.data.expiration)}),location.href=w();return}q(i,l(o.message)),p(g,u)}),p(g,u)})();})();
