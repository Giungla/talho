!function(){"use strict";var e="COMPLETED";function t(e){const t=m(document.cookie,"; ").find(t=>{const{name:o}=r(t);return o===e});return!!t&&r(t).value}function r(e){const[t,r]=m(e,"=",2);return{name:t,value:r}}var o="__Host-Talho-Session-Cookie",s="X-Talho-Session",n={redirect_to:encodeURIComponent(location.pathname+location.search)},a={path:"/",secure:!0,sameSite:"Strict",expires:new Date(Date.now()+1e3*p*14)};function i(e){const t=e?.headers.get(s);t&&function(e,t,r={}){if(0===l(e))throw new Error("'setCookie' should receive a valid cookie name");if(!["string","number","boolean"].includes(typeof t)||0===l(t.toString()))throw new Error("'setCookie' should receive a valid cookie value");const o=[`${e}=${t}`];f(r?.expires&&r?.expires instanceof Date,o,"expires="+r.expires.toUTCString()),f(r.maxAge,o,`maxAge=${r.maxAge}`),f(r?.sameSite&&"string"==typeof r?.sameSite,o,`SameSite=${r?.sameSite}`),f(r?.path,o,`path=${r?.path}`),f(r?.domain,o,`domain=${r?.domain}`),f(r?.httpOnly,o,"HttpOnly"),f(r?.secure,o,"Secure");const s=o.join("; ");document.cookie=s}(o,t,a)}function c(e,t=!1,r){return i(this),t||this&&401===this.status&&function(e="/acessos/entrar",t=n){location.href=function(e,t={}){const r=new URL(`${location.protocol}//${location.hostname}`),o=new URL(e,r);for(const[s,n]of Object.entries(t))o.searchParams.set(s,n);return o.toString()}(e,t)}(),r?.(),{message:e,succeeded:!1}}function d(e,t){return i(this),t?.(),{data:e,succeeded:!0}}function u(e=[],r="GET"){const n="application/json",a=new Headers({Accept:n,"Content-Type":n});for(const[t,o]of e)a.set(t,o);const i=t(o);i&&a.set(s,i);const c=t("__Host-Talho-AuthToken");return c&&a.set("Authorization",c),{method:r,headers:a}}var p=86400,h=null;function l(e){return e.length}function m(e,t,r){return e.split(t,r)}function f(e,t,r){return e?t.push(r):-1}new Event("input"),new Event("blur"),document.currentScript?.getAttribute("data-parameter-names");var{createApp:_}=Vue,g="transactionid",y="pix",w="creditcard",v={[y]:"PIX",[w]:"Cartão de crédito"},S="https://xef5-44zo-gegm.b2.xano.io/api:YomXpzWs";_({name:"TalhoOrderNoteApp",data:()=>({order:h,prepare_status:h,prepareMessage:h}),async created(){const e=new URLSearchParams(location.search).get(g);if(!e)return;const t=await this.getOrder(e);t.succeeded&&(this.order=t.data,this.prepare_status=t.data.order.prepare_status)},methods:{async getOrder(e){const t="Não foi possível encontrar o pedido";try{const r=await fetch(`${S}/order/delivery-prepare?${g}=${e}`,{...u()});if(!r.ok){const e=await r.json();return c.call(r,e?.message??t)}const o=await r.json();return d.call(r,o)}catch(r){return c(t)}},async handleOrderStatus(){const e=this.order,{prepare_status:t}=this;if(!e||!t)return;const r=await this.setOrderStatus(e.order.number,t);this.prepareMessage=r.succeeded?"Modificado com sucesso":r.message},async setOrderStatus(e,t){const r="Não foi possível alterar o status de preparação";try{const s=await fetch(`${S}/order/delivery-status`,{...u([],"PATCH"),body:(o={order_id:e,prepare_status:t},JSON.stringify(o))});if(!s.ok){const e=await s.json();return c.call(s,e?.message??r)}const n=await s.json();return d.call(s,n)}catch(s){return c(r)}var o},printPage(){window.print()}},computed:{finalOrderStatus:{get(){return this.order?.order?.status===e?e:this.prepare_status},set(e){this.prepare_status=e}},company(){return this.order?.company??h},customer(){return this.order?.customer??h},items(){return this.order?.items??h},itemsCount(){return l(this.items??[])},cOrder(){if(!this.order)return h;const{date:e,time:t,total:r,number:o,shipping:s,subtotal:n,discounts:a,change_for:i,notes_short:c,observations:d,payment_method:u,has_free_shipping:p}=this.order.order;return{date:e,time:t,total:r,number:o,shipping:s,subtotal:n,discounts:a,change_for:i,notes_short:c,observations:d,has_free_shipping:p,payment_method:v?.[u]}},deliveryDate(){if(!this.order)return h;const{order:e}=this.order;return`${e.delivery_date} ${e.delivery_hour}`},priorityTax(){const e=this.order?.order;return e&&e.has_priority?e?.priority_price:h},subsidyDiscount(){const e=this.order?.order;return e&&e.has_subsidy?e?.subsidy_price:h},pixDiscount(){const e=this.order?.order;return e&&"pix"===e.payment_method?{discountPrice:e.pix_discount_price,discountPercentual:e.pix_discount_percentual}:h},hasPaid(){return this.order?.order.paid??!1},deliveredAt(){return this.order?.order.delivered_at??h}}}).mount("#note-order"),window.addEventListener("pageshow",e=>{e.persisted&&window.location.reload()})}();