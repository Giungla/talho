"use strict";(()=>{var I="; ";function E(t){let e=document.cookie.split(I).find(r=>{let{name:n}=L(r);return n===t});return e?L(e).value:!1}function L(t){let[e,r]=t.split("=");return{name:e,value:r}}function h(t,e,r={}){if(t.length===0)throw new Error("'setCookie' should receive a valid cookie name");if(!["string","number","boolean"].includes(typeof e)||e.toString().length===0)throw new Error("'setCookie' should receive a valid cookie value");let n=[`${t}=${e}`];r?.expires&&r?.expires instanceof Date&&n.push("expires="+r.expires.toUTCString()),r.maxAge&&n.push(`maxAge=${r.maxAge}`),r?.sameSite&&typeof r?.sameSite=="string"&&n.push(`SameSite=${r?.sameSite}`),r?.path&&n.push(`path=${r?.path}`),r?.domain&&n.push(`domain=${r?.path}`),r?.httpOnly&&n.push("HttpOnly"),r?.secure&&n.push("Secure");let s=n.join(I);return document.cookie=s,s}var w="__Host-Talho-AuthToken",A="__Host-Talho-Session-Cookie",C="X-Talho-Session";function d(t){let e=this?.get(C);return e&&h(A,e,{path:"/",secure:!0,sameSite:"Strict",expires:new Date(Date.now()+_(90))}),{message:t,succeeded:!1}}function T(t){let e=this?.get(C);return e&&h(A,e,{path:"/",secure:!0,sameSite:"Strict",expires:new Date(Date.now()+_(90))}),{data:t,succeeded:!0}}function x(t=[],e="GET"){let r=new Headers({Accept:"application/json","Content-Type":"application/json"});for(let[S,b]of t)r.set(S,b);let n=E(A);n&&r.set(C,n);let s=E(w);return s&&r.set("Authorization",s),{method:e,headers:r}}function _(t){return 86400*1e3*t}var y=new Intl.NumberFormat("pt-BR",{currency:"BRL",style:"currency"});var u=null,p="oculto";function a(t,e=document){return e?e.querySelector(t):u}function M(t,e,r,n){if(t)return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function P(t,e){return t?t.classList.contains(e):!1}function l(t,e,r){return t?t.classList.toggle(e,r):!1}function i(t,e){t&&(t.textContent=typeof e=="string"?e:e.toString())}function v(t){return JSON.stringify(t)}function R(t){if(typeof t!="string")return null;try{return JSON.parse(t)}catch{return u}}function m(t){return t.length}var g="talho_cart_items",N={AC:"Acre",AL:"Alagoas",AP:"Amap\xE1",AM:"Amazonas",BA:"Bahia",CE:"Cear\xE1",DF:"Distrito Federal",ES:"Esp\xEDrito Santo",GO:"Goi\xE1s",MA:"Maranh\xE3o",MT:"Mato Grosso",MS:"Mato Grosso do Sul",MG:"Minas Gerais",PA:"Par\xE1",PB:"Para\xEDba",PR:"Paran\xE1",PE:"Pernambuco",PI:"Piau\xED",RJ:"Rio de Janeiro",RN:"Rio Grande do Norte",RS:"Rio Grande do Sul",RO:"Rond\xF4nia",RR:"Roraima",SC:"Santa Catarina",SP:"S\xE3o Paulo",SE:"Sergipe",TO:"Tocantins"},W=Object.keys(N),Z=Object.values(N);var H="https://xef5-44zo-gegm.b2.xano.io";var Q="carrinhoflutuante--visible",F=400,U=`${H}/api:79PnTkh_`,tt={cart:u,fetched:u,isPending:!1,isCartOpened:!0},o=new Proxy(tt,{get(t,e){switch(e){case"hasFreeShipping":return(t.cart?.order_price??0)>F;case"missingForFreeShipping":return Math.max(0,F-(t.cart?.order_price??0));case"getOrderPrice":return y.format(t.cart?.order_price??0);default:return Reflect.get(t,e)}},set(t,e,r){let n=Reflect.set(t,e,r);if(!n)return n;switch(e){case"isPending":break;case"isCartOpened":j();break;case"cart":it(),ct(),localStorage.setItem(g,JSON.stringify(r));break}return n}}),K=a("[data-wtf-floating-cart-item]"),O=a("[data-wtf-floating-cart-item-wrapper]"),et=a("[data-wtf-floating-cart-empty-cart]"),q=a("[data-wtf-promo-valid]"),G=a("[data-wtf-promo-invalid]"),rt=a("[data-wtf-floating-cart-total]");function c(t,e,r){return Object.prototype.hasOwnProperty.call(t,e)&&(!r||typeof t[e]===r)}function V(t){return Array.isArray(t)}function nt(t){return!c(t,"order_price","number")||!c(t,"items")||!V(t.items)?!1:m(t.items)===0?!0:t.items.every(e=>c(e,"name","string")&&c(e,"quantity","number")&&c(e,"price","number")&&c(e,"imageUrl","string")&&c(e,"sku_id","number")&&c(e,"slug","string"))}async function j(){if(!o.isCartOpened)return;let t=R(localStorage.getItem(g));if(t&&nt(t)){o.fetched??=!0,o.cart=t;return}else localStorage.removeItem(g);o.isPending=!0;let e=await ot();o.fetched??=!0,o.isPending=!1,e.succeeded&&(o.cart=e.data)}async function ot(){let t="Houve uma falha ao buscar o seu carrinho";try{let e=await fetch(`${U}/cart/get`,{...x()});if(!e.ok){let n=await e.json();return d.call(e.headers,n?.message??t)}let r=await e.json();return T.call(e.headers,r)}catch{return d(t)}}async function at(t,e){let r="Houve uma falha ao buscar o seu carrinho";try{let n=await fetch(`${U}/cart/handle`,{...x([],"POST"),body:v({item:t,operation:e})});if(!n.ok){let S=await n.json();return d.call(n.headers,S?.message??r)}let s=await n.json();return T.call(n.headers,s)}catch{return d(r)}}async function st(t,e){if(o.isPending)return;o.isPending=!0;let r=await at({...e,quantity:1},t);o.isPending=!1,r.succeeded&&(o.cart=r.data)}function it(){if(i(rt,o.getOrderPrice),!V(o.cart?.items)||!K||!O)return;if(l(a("[data-wtf-floating-cart-total-block]"),p,m(o.cart?.items)===0),l(a("[data-wtf-floating-cart-checkout-button]",k),p,m(o.cart?.items)===0),!l(et,p,m(o.cart?.items)>0))return i(a("[data-wtf-floating-cart-items-indicator]"),"0"),O.replaceChildren();let t=0,e=document.createDocumentFragment();for(let{slug:r,imageUrl:n,quantity:s,price:S,sku_id:b,name:$}of o.cart.items){t+=s;let f=K.cloneNode(!0);i(a("[data-wtf-floating-cart-item-product-name]",f),$),i(a("[data-wtf-floating-cart-item-quantity]",f),s.toString()),i(a("[data-wtf-floating-cart-item-product-price]",f),y.format(S));let D=a("[data-wtf-floating-cart-item-image]",f);D&&(D.style.backgroundImage=`url('${n}')`);let z={sku_id:b,reference_id:r},B=[["delete","data-wtf-floating-cart-item-remove"],["increase","data-wtf-floating-cart-item-plus-button"],["decrease","data-wtf-floating-cart-item-minus-button"]];for(let[J,Y]of B)M(a(`[${Y}]`,f),"click",X=>ut.call(X,J,z));e.appendChild(f)}i(a("[data-wtf-floating-cart-items-indicator]"),t.toString()),O?.replaceChildren(e)}function ct(){let{hasFreeShipping:t}=o;return l(q,p,!t),l(G,p,t),t?i(a("[data-wtf-promo-validada-txt-sem-imagem]",q),"Voc\xEA ganhou frete gr\xE1tis"):i(a("[data-wtf-promo-invalidada-txt]",G),`Adicione mais ${y.format(o.missingForFreeShipping)} e ganhe frete gr\xE1tis`)}async function ut(t,e){this.preventDefault(),this.stopPropagation(),await st(t,e)}var k=a("[data-wtf-floating-cart]"),pt=new MutationObserver(t=>{let e=t[0].target,r=P(e,Q);o.isCartOpened=r,window.scrollTo({top:0,behavior:"instant"}),document.body.style.overflow=r?"hidden":"unset"});k&&(pt.observe(k,{attributes:!0,attributeFilter:["class"]}),O&&(window.addEventListener("storage",function(t){t.key===g&&(o.cart=t.newValue?R(t.newValue):u)}),j().then(()=>{o.isCartOpened=!1})));})();
