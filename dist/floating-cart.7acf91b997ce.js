"use strict";(()=>{var O="; ";function S(t){let e=document.cookie.split(O).find(r=>{let{name:n}=_(r);return n===t});return e?_(e).value:!1}function _(t){let[e,r]=t.split("=");return{name:e,value:r}}function b(t,e,r={}){if(t.length===0)throw new Error("'setCookie' should receive a valid cookie name");if(!["string","number","boolean"].includes(typeof e)||e.toString().length===0)throw new Error("'setCookie' should receive a valid cookie value");let n=[`${t}=${e}`];r?.expires&&r?.expires instanceof Date&&n.push("expires="+r.expires.toUTCString()),r.maxAge&&n.push(`maxAge=${r.maxAge}`),r?.sameSite&&typeof r?.sameSite=="string"&&n.push(`SameSite=${r?.sameSite}`),r?.path&&n.push(`path=${r?.path}`),r?.domain&&n.push(`domain=${r?.path}`),r?.httpOnly&&n.push("HttpOnly"),r?.secure&&n.push("Secure");let s=n.join(O);return document.cookie=s,s}var tt=401,I="__Host-Talho-AuthToken",L="__Host-Talho-Session-Cookie",w="X-Talho-Session";function et(t){!t||t.status!==tt||(location.href=P("/acessos/entrar",{redirect_to:encodeURIComponent(location.pathname)}))}function U(t){let e=t?.headers.get(w);e&&b(L,e,{path:"/",secure:!0,sameSite:"Strict",expires:new Date(Date.now()+N(90))})}function m(t){return U(this),et(this),{message:t,succeeded:!1}}function y(t){return U(this),{data:t,succeeded:!0}}function A(t=[],e="GET"){let r=new Headers({Accept:"application/json","Content-Type":"application/json"});for(let[c,x]of t)r.set(c,x);let n=S(L);n&&r.set(w,n);let s=S(I);return s&&r.set("Authorization",s),{method:e,headers:r}}function N(t){return 86400*1e3*t}var C=new Intl.NumberFormat("pt-BR",{currency:"BRL",style:"currency"});var p=null,l="oculto";function h(t){return Array.isArray(t)}function o(t,e=document){return e?e.querySelector(t):p}function M(t,e,r,n){if(t)return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function v(t,e){return t?t.classList.contains(e):!1}function f(t,e,r){return t?t.classList.toggle(e,r):!1}function i(t,e){t&&(t.textContent=typeof e=="string"?e:e.toString())}function P(t,e={}){let r=new URL(`${location.protocol}//${location.hostname}`),n=new URL(t,r);for(let[s,c]of Object.entries(e))n.searchParams.set(s,c);return n.toString()}function k(t){return JSON.stringify(t)}function T(t){if(typeof t!="string")return null;try{return JSON.parse(t)}catch{return p}}function g(t){return t.length}var E="talho_cart_items";var H={AC:"Acre",AL:"Alagoas",AP:"Amap\xE1",AM:"Amazonas",BA:"Bahia",CE:"Cear\xE1",DF:"Distrito Federal",ES:"Esp\xEDrito Santo",GO:"Goi\xE1s",MA:"Maranh\xE3o",MT:"Mato Grosso",MS:"Mato Grosso do Sul",MG:"Minas Gerais",PA:"Par\xE1",PB:"Para\xEDba",PR:"Paran\xE1",PE:"Pernambuco",PI:"Piau\xED",RJ:"Rio de Janeiro",RN:"Rio Grande do Norte",RS:"Rio Grande do Sul",RO:"Rond\xF4nia",RR:"Roraima",SC:"Santa Catarina",SP:"S\xE3o Paulo",SE:"Sergipe",TO:"Tocantins"},rt=Object.keys(H),nt=Object.values(H);var G="https://xef5-44zo-gegm.b2.xano.io";var ot="carrinhoflutuante--visible",$=`${G}/api:79PnTkh_`,at={cart:p,fetched:p,isPending:!1,isCartOpened:!0},a=new Proxy(at,{get(t,e){switch(e){case"hasFreeShipping":return(t.cart?.order_price??0)>400;case"missingForFreeShipping":return Math.max(0,400-(t.cart?.order_price??0));case"getOrderPrice":return C.format(t.cart?.order_price??0);default:return Reflect.get(t,e)}},set(t,e,r){let n=Reflect.set(t,e,r);if(!n)return n;switch(e){case"isPending":break;case"isCartOpened":z();break;case"cart":ft(),dt(),localStorage.setItem(E,JSON.stringify(r));break}return n}}),q=o("[data-wtf-floating-cart-item]"),R=o("[data-wtf-floating-cart-item-wrapper]"),st=o("[data-wtf-floating-cart-empty-cart]"),V=o("[data-wtf-promo-valid]"),j=o("[data-wtf-promo-invalid]"),it=o("[data-wtf-floating-cart-total]");function u(t,e,r){return Object.prototype.hasOwnProperty.call(t,e)&&(!r||typeof t[e]===r)}function ct(t){return!u(t,"order_price","number")||!u(t,"items")||!h(t.items)?!1:g(t.items)===0?!0:t.items.every(e=>u(e,"name","string")&&u(e,"quantity","number")&&u(e,"price","number")&&u(e,"imageUrl","string")&&u(e,"sku_id","number")&&u(e,"slug","string"))}async function z(){if(!a.isCartOpened)return;let t=T(localStorage.getItem(E));if(t&&ct(t)){a.fetched??=!0,a.cart=t;return}else localStorage.removeItem(E);a.isPending=!0;let e=await ut();a.fetched??=!0,a.isPending=!1,e.succeeded&&(a.cart=e.data)}async function ut(){let t="Houve uma falha ao buscar o seu carrinho";try{let e=await fetch(`${$}/cart/get`,{...A()});if(!e.ok){let n=await e.json();return m.call(e,n?.message??t)}let r=await e.json();return y.call(e,r)}catch{return m(t)}}async function pt(t,e){let r="Houve uma falha ao buscar o seu carrinho";try{let n=await fetch(`${$}/cart/handle`,{...A([],"POST"),body:k({item:t,operation:e})});if(!n.ok){let c=await n.json();return m.call(n,c?.message??r)}let s=await n.json();return y.call(n,s)}catch{return m(r)}}async function lt(t,e){if(a.isPending)return;a.isPending=!0;let r=await pt({...e,quantity:1},t);a.isPending=!1,r.succeeded&&(a.cart=r.data)}function ft(){i(it,a.getOrderPrice);let t=a.cart?.items;if(!h(t)||!q||!R)return;if(f(o("[data-wtf-floating-cart-total-block]"),l,g(t)===0),f(o("[data-wtf-floating-cart-checkout-button]",F),l,g(t)===0),!f(st,l,g(t)>0))return i(o("[data-wtf-floating-cart-items-indicator]"),"0"),R.replaceChildren();let e=0,r=document.createDocumentFragment();for(let{slug:n,imageUrl:s,quantity:c,price:x,sku_id:B,name:J}of t){e+=c;let d=q.cloneNode(!0);i(o("[data-wtf-floating-cart-item-product-name]",d),J),i(o("[data-wtf-floating-cart-item-quantity]",d),c.toString()),i(o("[data-wtf-floating-cart-item-product-price]",d),C.format(x));let K=o("[data-wtf-floating-cart-item-image]",d);K&&(K.style.backgroundImage=`url('${s}')`);let Y={sku_id:B,reference_id:n},X=[["delete","data-wtf-floating-cart-item-remove"],["increase","data-wtf-floating-cart-item-plus-button"],["decrease","data-wtf-floating-cart-item-minus-button"]];for(let[W,Z]of X)M(o(`[${Z}]`,d),"click",Q=>mt.call(Q,W,Y));r.appendChild(d)}i(o("[data-wtf-floating-cart-items-indicator]"),e.toString()),R?.replaceChildren(r)}function dt(){let{hasFreeShipping:t}=a;return f(V,l,!t),f(j,l,t),t?i(o("[data-wtf-promo-validada-txt-sem-imagem]",V),"Voc\xEA ganhou frete gr\xE1tis"):i(o("[data-wtf-promo-invalidada-txt]",j),`Adicione mais ${C.format(a.missingForFreeShipping)} e ganhe frete gr\xE1tis`)}async function mt(t,e){this.preventDefault(),this.stopPropagation(),await lt(t,e)}var F=o("[data-wtf-floating-cart]"),gt=new MutationObserver(t=>{let e=t[0].target,r=v(e,ot);a.isCartOpened=r,window.scrollTo({top:0,behavior:"instant"}),document.body.style.overflow=r?"hidden":"unset"});F&&(gt.observe(F,{attributes:!0,attributeFilter:["class"]}),R&&(window.addEventListener("storage",function(t){t.key===E&&(a.cart=t.newValue?T(t.newValue):p)}),z().then(()=>{a.isCartOpened=!1})));})();
