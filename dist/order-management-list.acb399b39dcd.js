!function(){"use strict";var e="NOTSTARTED",t="PREPARED",a="PREPARING",r="DELIVERYREADY",n="COMPLETED";function s(e){const t=u((a=document.cookie,a.replace(/\s{2,}/g," ")),"; ").find(t=>{const{name:a}=o(t);return a===e});var a;return!!t&&o(t).value}function o(e){const[t,...a]=u(e,"=");return{name:t,value:c(a)>0&&decodeURIComponent(a.join("="))}}var i=null;function c(e){return e.length}function u(e,t,a){return e.split(t,a)}var d="__Host-Talho-Session-Cookie",l="X-Talho-Session",h={redirect_to:encodeURIComponent(location.pathname+location.search)},m={path:"/",secure:!0,sameSite:"Strict",expires:new Date(Date.now()+12096e5)};function p(e){const t=e?.headers.get(l);t&&function(e,t,a={}){if(0===c(e))throw new Error("'setCookie' should receive a valid cookie name");if(!["string","number","boolean"].includes(typeof t)||0===c(t.toString()))throw new Error("'setCookie' should receive a valid cookie value");const r=[`${e}=${encodeURIComponent(t)}`];E(a?.expires&&a?.expires instanceof Date,r,"expires="+a.expires?.toUTCString()),E(a.maxAge,r,`maxAge=${a.maxAge}`),E(a?.sameSite&&"string"==typeof a?.sameSite,r,`SameSite=${a?.sameSite}`),E(a?.path,r,`path=${a?.path}`),E(a?.domain,r,`domain=${a?.domain}`),E(a?.httpOnly,r,"HttpOnly"),E(a?.secure,r,"Secure");const n=r.join("; ");document.cookie=n}(d,t,m)}function g(e,t=!1,a){return p(this),t||this&&401===this.status&&function(e="/acessos/entrar",t=h){location.href=function(e,t={}){const a=new URL(`${location.protocol}//${location.hostname}`),r=new URL(e,a);for(const[n,s]of Object.entries(t))r.searchParams.set(n,s);return r.toString()}(e,t)}(),a?.(),{message:e,succeeded:!1}}function f(e,t){return p(this),t?.(),{data:e,succeeded:!0}}function v(e=[],t="GET"){const a="application/json",r=new Headers({Accept:a,"Content-Type":a});for(const[s,i]of e)r.set(s,i);const n=s(d);n&&r.set(l,n);const o=s("__Host-Talho-AuthToken");return o&&r.set("Authorization",o),{method:t,headers:r}}var w=new Intl.NumberFormat("pt-BR",{currency:"BRL",style:"currency"});function E(e,t,a){return e?t.push(a):-1}function P(e,t){return e===t}new Event("input"),new Event("blur"),document.currentScript?.getAttribute("data-parameter-names");var{createApp:b}=Vue,y=b({name:"OrderManagementApp",async created(){this.handlePaginate(1)},data:()=>({startDate:i,orders:i,activeFilter:i,availableFilters:[{label:"Não iniciado",name:e},{label:"Em preparação",name:a},{label:"Preparado",name:t},{label:"Pronto para entrega",name:r},{label:"Pedido entregue",name:n}]}),methods:{async getOrders(e=1){const t="Houve uma falha com a busca de pedidos";try{const a=await fetch(`https://xef5-44zo-gegm.b2.xano.io/api:YomXpzWs/order/list?page=${e}`,{...v()});if(!a.ok){const e=await a.json();return g.call(a,e?.message??t)}const r=await a.json();return f.call(a,r)}catch(a){return g(t)}},applyFilter(e){P(this.activeFilter,e)||(this.activeFilter=e)},getFilterByToken(e){return this.getAppliableFilters.find(({name:t})=>P(t,e))},async handlePaginate(e){const t=await this.getOrders(e);var a,r;t.succeeded&&(this.orders=t.data,r={block:"start",behavior:"smooth"},(a=S)&&a.scrollIntoView(r))}},computed:{hasOrders(){const{orders:e}=this,t=e?.itemsReceived;return"number"==typeof t&&t>0},getParsedOrders(){if(!this.hasOrders)return[];const{orders:s,activeFilter:o}=this;return(null!==o?s.items.filter(({prepare_status:s,status:i})=>{switch(o){case"ASSIGNING_DRIVER":case"CANCELED":case"ON_GOING":case"PICKED_UP":case"REJECTED":case"EXPIRED":case n:return P(i,o);case e:case a:case t:case r:return!P(i,n)&&P(s,o)}}):s.items).map(({total:e,transaction_id:t,created_at:a,order_items:r,prepare_status:s,status:o,...i})=>{const c=o===n?o:s;return{...i,created_date:(u=a,new Date(u).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),items_count:r,price:w.format(e/100),url:`/adm/ficha-de-pedido?transactionid=${t}`,...c&&{delivery_status:this.getFilterByToken(c)}};var u})??[]},getAppliableFilters(){if(!this.hasOrders)return[];const{getAvailableStatus:e}=this;return this.availableFilters.reduce((t,a)=>e.includes(a.name)?t.concat({...a,className:a.name?.toLowerCase(),name:a.name}):t,[])},getAvailableStatus(){if(!this.hasOrders)return[];const e=[];for(const{prepare_status:t,status:a}of this.orders?.items)E(!e.includes(t),e,t),E(a&&!e.includes(a),e,a);return e},hasPrevPage(){return this.orders?.prevPage!==i},hasNextPage(){return this.orders?.nextPage!==i},hasLastPage(){const e=this.orders;return t=[e?.nextPage,e?.curPage],a=e?.pageTotal,t.includes(a);var t,a},hasFirstPage(){const e=this.orders?.curPage;return"number"==typeof e&&e>2}}}),S=function(e,t=document){return t?t.querySelector(e):i}("#order-management-list");y.mount(S),window.addEventListener("pageshow",e=>{e.persisted&&window.location.reload()})}();