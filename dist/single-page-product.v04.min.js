(()=>{let o=null,u="oculto",n="https://xef5-44zo-gegm.b2.xano.io",r=n+"/api:79PnTkh_",s="click",d="{count}",l=[`Temos apenas ${d} unidade disponível.`,`Temos apenas ${d} unidades disponíveis.`];var t={quantity:1,stockCount:0,product:o,selectedVariation:o};let c=location.pathname.split("/");function f(t,e){return{method:t,...e&&{credentials:"include"},headers:{Accept:"application/json","Content-Type":"application/json"}}}let p=new Proxy(t,{get(a,t){switch(t){case"variationsCount":return _(a.product?.variations??[]);case"hasPriceDifference":var{price:r,full_price:e}=p.prices;return r!==e;case"prices":{let{product:t,selectedVariation:e}=a;return t&&p.hasSelectedVariation?(r=t.variations.find(t=>t.id===e))?x(r.price,r.full_price):x():x()}case"BRLPrices":var{price:e,full_price:r}=p.prices;return x(g.format(e),g.format(r));case"computedFinalPrices":var{quantity:e,prices:r}=p,i=r.price*e,r=r.full_price*e;return{price:{price:i,full_price:r},currency:{price:g.format(i),full_price:g.format(r)}};case"hasSelectedVariation":return a.selectedVariation!==o;default:return Reflect.get(a,t)}},set(t,e,a){var r,i,n,t=Reflect.set(t,e,a);switch(e){case"quantity":S(B,String(a??1)),(r=p.product)&&p.hasSelectedVariation&&(r=t=>C("[data-wtf-price-value]",t),{BRLPrices:i,hasPriceDifference:n,computedFinalPrices:c}=p,S(r(m),i.price),S(r(h),i.full_price),S(r(O),c.currency.price),j(m,u,!n),j(h,u,!n));break;case"selectedVariation":(()=>{if(y&&z&&p.product){var{selectedVariation:e,product:a}=p,r=document.createDocumentFragment(),t=C("[data-wtf-weight-selector]"),i=p.variationsCount<2;if(i)return t?.remove();j(t,u,i);for(let t of a?.variations){var n=document.createElement("div"),c=e===t.id;T(n,"text-block"),j(n,"selecionado",c),S(n,k(t.label,/\./g,",")),c||P(n,s,()=>{var e;e=t.id,p.product?.variations.some(({id:t})=>t===e)&&(p.selectedVariation=e)}),r.appendChild(n)}y.replaceChildren(r)}})(),Reflect.set(p,"quantity",1);break;case"stockCount":i=p.stockCount,j(F,u,0<i),(r=j(v,u,10<i||i<1))||(r=_(l)-1,S(C("div",v),k(l[b(0,r,i-1)],d,i.toString()))),D(0);break;case"product":var c=a;Reflect.set(p,"stockCount",c?.stock_quantity??0),Reflect.set(p,"selectedVariation",c?.variations[0].id??o)}return t}}),v=C("[data-wtf-error-message-sku-maximum]"),F=C("[data-wtf-error-message-invetory]"),M=C("[data-wtf-quantity-minus]"),A=C("[data-wtf-quantity-plus]"),B=C("[data-wtf-quantity-value]"),m=C("[data-wtf-price]"),h=C("[data-wtf-full-price]"),O=C("[data-wtf-total]"),y=C("[data-wtf-sku-list]"),z=C("[data-wtf-sku-item]"),e=C("[data-wtf-shipping-button]"),w=C("[data-wtf-shipping-form]"),a=C("[data-wtf-shipping-value]"),I=C("[data-wtf-comprar]"),g=new Intl.NumberFormat("pt-BR",{currency:"BRL",style:"currency"});function k(t,e,a){return t.replace(e,a)}function q(t){return JSON.stringify(t)}function b(t,e,a){return Math.max(t,Math.min(e,a))}function _(t){return t.length}function C(t,e=document){return e?e.querySelector(t):o}function P(t,e,a,r){t&&t.addEventListener(e,a,r)}function S(t,e){t&&(t.textContent=e)}function T(t,...e){t&&t.classList.add(...e)}function V(t,...e){t&&t.classList.remove(...e)}function j(t,e,a){return!!t&&t.classList.toggle(e,a)}function L(t){return{message:t,succeeded:!1}}function R(t){return{data:t,succeeded:!0}}function x(t=0,e=0){return{price:t,full_price:e}}function D(t){t+=p.quantity,t=b(1,Math.min(p.stockCount,10),t);t!==p.quantity&&(p.quantity=t)}async function N(t){t.preventDefault();var{quantity:t,product:e,selectedVariation:a}=p;if(a&&e&&0!==p.stockCount){t=await(async t=>{var e="Falha ao adicionar o produto";try{var a=await fetch(r+"/cart/handle",{...f("POST",!0),body:q({item:t,operation:"add"})});return a.ok?R(await a.json()):L((await a.json())?.message??e)}catch(t){return L("[CATCH] "+e)}})({quantity:t,sku_id:a,reference_id:e.slug});if(!t.succeeded)return alert("A adição falhou");p.quantity=1,T(C("#carrinho-flutuante"),"carrinhoflutuante--visible"),localStorage.setItem("talho_cart_items",q(t.data))}}function H(t){return t.replace(/^(\d{0,5})(\d{0,3})/,(t,e,a)=>{var r,i=[];for(r of[e,a])r&&i.push(r);return i.join("-")})}function i(){var t=C("form",w);if(t){var e,a,i;for(e of["name","method","data-name","aria-label","data-wf-page-id","data-wf-element-id","data-turnstile-sitekey"])a=t,i=e,a&&a.removeAttribute(i);V(w,"w-form"),t.parentElement.innerHTML=t.outerHTML;let r=C("#shipping-cep-form");r&&(P(r,"input",t=>{t.stopPropagation();var e=t.target,a=e.value.replace(/\D+/g,"");"cep"===e.name&&e.value!==H(a)&&t.isTrusted&&(e.value=H(a),e.dispatchEvent(new Event("input")))}),P(r,"submit",async t=>{t.preventDefault();var e,a=await(async t=>{var e="Houve uma falha ao gerar a cotação";try{var a=await fetch(n+"/api:i6etHc7G/site/product-delivery",{...f("POST",!0),body:q(t)});return a.ok?R(await a.json()):L((await a.json())?.message??e)}catch(t){return L(e)}})({cep:r.cep.value,reference_id:c[_(c)-1]});if(a.succeeded)switch(a.data.type){case"quotation":return E(a.data.data);case"locationlist":return e=a.data.data,void console.log(e.length," localizações recebidas")}}))}}function E(t){T(e,u),T(w,u),V(a,u),S(C("[data-wtf-quotation-price]",a),g.format(t.total/100)),P(C("[data-wtf-quotation-reload]",a),"click",t=>{V(w,u),T(a,u)},{once:!0})}(async t=>{var e="Houve uma falha ao capturar o produto";try{var a=await fetch(r+"/product/single-product-page",{...f("POST",!0),body:q({quantity:1,reference_id:t})});return a.ok?R(await a.json()):L((await a.json())?.message??e)}catch(t){return L(e)}})(c[_(c)-1]).then(t=>{t.succeeded&&(p.product=t.data.product,t.data.delivery!==o)&&(i(),E(t.data.delivery))}).then(()=>{P(A,s,()=>D(1)),P(M,s,()=>D(-1)),P(I,s,N),P(e,s,t=>{t.preventDefault(),T(e,u),V(w,u),i()},{once:!0})})})();